2025-05-16 23:13:06,602 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:13:06,603 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:13:06,621 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:13:06,622 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:13:06,623 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:13:06,624 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:13:06,633 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:13:06,644 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:13:07,516 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:13:07,517 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:13:07,518 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:13:07,542 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:13:07,551 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:13:07,551 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:13:07,726 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:13:07,931 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:13:07,931 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:13:07,932 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:13:07,938 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:13:07,938 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:13:07,939 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:13:07,960 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:13:08,002 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:13:08,087 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:13:08,192 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:13:08,192 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:13:08,221 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:13:08,248 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:13:08,248 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:13:08,277 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:13:08,307 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:13:08,351 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:13:08,351 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:13:08,357 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:13:08,429 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:13:08,495 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:13:08,531 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:13:08,578 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:13:08,610 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:13:08,611 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number']
2025-05-16 23:13:08,681 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:13:08,754 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:13:08,825 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:13:08,828 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:13:08,829 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:13:08,829 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:13:08,898 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:15:07,964 - INFO - Celda 8.1: Analizando valores únicos para columnas que no son 'category' ni 'boolean'.
2025-05-16 23:15:07,967 - INFO - Columnas de tipo 'category' o 'boolean' que se omitirán en este análisis: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'is_host_unconfirmed', 'is_host_verified', 'is_instant_bookable_false_policy', 'is_instant_bookable_true_policy']
2025-05-16 23:15:07,969 - INFO - Análisis de valores únicos para 'id' (Tipo: int64) completado. Únicos: 102058.
2025-05-16 23:15:08,024 - INFO - Análisis de valores únicos para 'name' (Tipo: object) completado. Únicos: 61282.
2025-05-16 23:15:08,027 - INFO - Análisis de valores únicos para 'host_id' (Tipo: int64) completado. Únicos: 102057.
2025-05-16 23:15:08,050 - INFO - Análisis de valores únicos para 'host_name' (Tipo: object) completado. Únicos: 13191.
2025-05-16 23:15:08,066 - INFO - Análisis de valores únicos para 'neighbourhood' (Tipo: object) completado. Únicos: 225.
2025-05-16 23:15:08,072 - INFO - Análisis de valores únicos para 'lat' (Tipo: float64) completado. Únicos: 21992.
2025-05-16 23:15:08,078 - INFO - Análisis de valores únicos para 'long' (Tipo: float64) completado. Únicos: 17775.
2025-05-16 23:15:08,098 - INFO - Análisis de valores únicos para 'country' (Tipo: object) completado. Únicos: 2.
2025-05-16 23:15:08,117 - INFO - Análisis de valores únicos para 'country_code' (Tipo: object) completado. Únicos: 2.
2025-05-16 23:15:08,121 - INFO - Análisis de valores únicos para 'construction_year' (Tipo: float64) completado. Únicos: 21.
2025-05-16 23:15:08,138 - INFO - Análisis de valores únicos para 'price' (Tipo: object) completado. Únicos: 1152.
2025-05-16 23:15:08,155 - INFO - Análisis de valores únicos para 'service_fee' (Tipo: object) completado. Únicos: 232.
2025-05-16 23:15:08,160 - INFO - Análisis de valores únicos para 'minimum_nights' (Tipo: float64) completado. Únicos: 154.
2025-05-16 23:15:08,163 - INFO - Análisis de valores únicos para 'number_of_reviews' (Tipo: float64) completado. Únicos: 477.
2025-05-16 23:15:08,182 - INFO - Análisis de valores únicos para 'last_review' (Tipo: object) completado. Únicos: 2478.
2025-05-16 23:15:08,186 - INFO - Análisis de valores únicos para 'reviews_per_month' (Tipo: float64) completado. Únicos: 1017.
2025-05-16 23:15:08,189 - INFO - Análisis de valores únicos para 'calculated_host_listings_count' (Tipo: float64) completado. Únicos: 79.
2025-05-16 23:15:08,193 - INFO - Análisis de valores únicos para 'availability_365' (Tipo: float64) completado. Únicos: 439.
2025-05-16 23:15:08,209 - INFO - Análisis de valores únicos para 'house_rules' (Tipo: object) completado. Únicos: 1977.
2025-05-16 23:15:08,215 - INFO - Análisis de valores únicos para 'license' (Tipo: object) completado. Únicos: 2.
2025-05-16 23:18:57,567 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:18:57,714 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:20:30,064 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:20:30,067 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:20:30,082 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:20:30,083 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:20:30,085 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:20:30,086 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:20:30,160 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:20:30,162 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:20:31,074 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:20:31,075 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:20:31,075 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:20:31,133 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:20:31,139 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:20:31,141 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:20:31,334 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:20:31,537 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:20:31,537 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:20:31,538 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:20:31,543 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:20:31,545 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:20:31,545 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:20:31,556 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:20:31,599 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:20:31,700 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:20:31,811 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:20:31,812 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:20:31,846 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:20:31,879 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:20:31,879 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:20:31,914 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:20:31,947 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:20:31,984 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:20:31,985 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:20:31,991 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:20:32,053 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:20:32,121 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:20:32,157 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:20:32,207 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:20:32,237 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:20:32,238 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number']
2025-05-16 23:20:32,308 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:20:32,375 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:20:32,443 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:20:32,446 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:20:32,446 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:20:32,447 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:20:32,456 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:20:32,612 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:20:32,617 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:23:07,883 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:23:07,884 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:23:07,892 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:23:07,893 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:23:07,907 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:23:07,908 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:23:07,970 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:23:07,971 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:23:09,074 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:23:09,075 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:23:09,076 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:23:09,142 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:23:09,155 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:23:09,156 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:23:09,411 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:23:09,683 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:23:09,683 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:23:09,684 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:23:09,691 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:23:09,692 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:23:09,693 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:23:09,714 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:23:09,775 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:23:09,944 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:23:10,109 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:23:10,110 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:23:10,156 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:23:10,198 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:23:10,199 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:23:10,246 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:23:10,292 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:23:10,338 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:23:10,339 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:23:10,346 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:23:10,448 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:23:10,562 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:23:10,617 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:23:10,702 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:23:10,735 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:23:10,736 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:23:10,835 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:23:10,942 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:23:11,032 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:23:11,034 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:23:11,035 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:23:11,130 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:23:11,131 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:23:11,138 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:23:11,314 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:23:11,320 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:23:28,132 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:23:28,134 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:23:28,144 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:23:28,144 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:23:28,146 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:23:28,147 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:23:28,178 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:23:28,179 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:23:29,116 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:23:29,117 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:23:29,118 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:23:29,181 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:23:29,188 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:23:29,189 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:23:29,442 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:23:29,705 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:23:29,706 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:23:29,706 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:23:29,711 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:23:29,712 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:23:29,713 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:23:29,725 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:23:29,779 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:23:29,934 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:23:30,092 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:23:30,093 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:23:30,135 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:23:30,178 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:23:30,179 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:23:30,237 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:23:30,283 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:23:30,326 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:23:30,327 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:23:30,332 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:23:30,416 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:23:30,530 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:23:30,592 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:23:30,680 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:23:30,713 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:23:30,714 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:23:30,802 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:23:30,892 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:23:31,015 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:23:31,018 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:23:31,020 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:23:31,163 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:23:31,164 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:23:31,170 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:23:31,349 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:23:31,354 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:33:00,562 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:33:00,563 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:33:00,605 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:33:00,729 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:33:00,863 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:33:00,868 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:33:00,874 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:33:00,879 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:33:00,885 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:33:00,891 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:33:48,885 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:33:48,886 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:33:48,894 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:33:48,906 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:33:48,908 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:33:48,909 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:33:48,944 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:33:48,945 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:33:49,950 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:33:49,951 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:33:49,952 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:33:50,017 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:33:50,024 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:33:50,025 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:33:50,264 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:33:50,579 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:33:50,580 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:33:50,580 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:33:50,585 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:33:50,587 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:33:50,588 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:33:50,605 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:33:50,659 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:33:50,804 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:33:50,958 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:33:50,959 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:33:51,002 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:33:51,046 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:33:51,046 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:33:51,092 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:33:51,138 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:33:51,180 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:33:51,181 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:33:51,187 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:33:51,265 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:33:51,364 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:33:51,413 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:33:51,487 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:33:51,518 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:33:51,519 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:33:51,603 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:33:51,687 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:33:51,777 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:33:51,780 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:33:51,781 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:33:51,868 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:33:51,869 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:33:51,876 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:33:52,041 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:33:52,052 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:33:52,053 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:33:52,094 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:33:52,221 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:33:52,344 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:33:52,350 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:33:52,355 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:33:52,361 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:33:52,368 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:33:52,373 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:33:52,383 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:34:27,172 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:34:27,178 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:34:27,186 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:34:27,187 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:34:27,188 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:34:27,189 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:34:27,238 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:34:27,240 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:34:28,687 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:34:28,688 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:34:28,689 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:34:28,764 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:34:28,772 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:34:28,774 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:34:29,048 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:34:29,584 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:34:29,584 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:34:29,585 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:34:29,590 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:34:29,592 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:34:29,592 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:34:29,617 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:34:29,673 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:34:29,830 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:34:29,988 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:34:29,989 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:34:30,039 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:34:30,087 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:34:30,088 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:34:30,139 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:34:30,188 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:34:30,237 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:34:30,237 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:34:30,245 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:34:30,497 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:34:30,614 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:34:30,670 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:34:30,747 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:34:30,779 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:34:30,780 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:34:30,867 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:34:30,955 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:34:31,043 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:34:31,047 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:34:31,048 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:34:31,138 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:34:31,139 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:34:31,146 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:34:31,320 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:34:31,331 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:34:31,332 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:34:31,376 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:34:31,517 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:34:31,653 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:34:31,660 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:34:31,668 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:34:31,673 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:34:31,679 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:34:31,684 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:34:31,694 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:34:57,320 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:34:57,335 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:34:57,362 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:34:57,524 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:34:57,661 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:34:57,661 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:34:57,662 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:34:57,663 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:34:57,663 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:34:57,664 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:35:12,633 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:35:12,634 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:35:12,655 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:35:12,656 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:35:12,657 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:35:12,658 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:35:12,693 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:35:12,694 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:35:13,888 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:35:13,889 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:35:13,889 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:35:13,963 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:35:13,970 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:35:13,971 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:35:14,238 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:35:14,508 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:35:14,509 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:35:14,510 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:35:14,517 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:35:14,518 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:35:14,519 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:35:14,536 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:35:14,599 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:35:14,762 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:35:14,935 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:35:14,936 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:35:14,986 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:35:15,035 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:35:15,035 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:35:15,087 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:35:15,140 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:35:15,188 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:35:15,189 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:35:15,195 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:35:15,291 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:35:15,396 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:35:15,448 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:35:15,528 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:35:15,561 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:35:15,562 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:35:15,658 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:35:15,748 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:35:15,843 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:35:15,845 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:35:15,846 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:35:15,950 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:35:15,951 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:35:15,972 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:35:16,150 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:35:16,161 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:35:16,162 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:35:16,208 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:35:16,335 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:35:16,459 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:35:16,465 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:35:16,470 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:35:16,476 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:35:16,482 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:35:16,488 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:35:16,493 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:38:47,079 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:38:47,080 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:38:47,088 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:38:47,089 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:38:47,091 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:38:47,091 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:38:47,142 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:38:47,143 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:38:48,167 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:38:48,167 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:38:48,168 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:38:48,246 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:38:48,254 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:38:48,256 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:38:48,529 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:38:48,813 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:38:48,813 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:38:48,814 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:38:48,819 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:38:48,821 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:38:48,822 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:38:48,847 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:38:48,908 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:38:49,074 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:38:49,239 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:38:49,241 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:38:49,293 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:38:49,365 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:38:49,366 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:38:49,420 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:38:49,469 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:38:49,510 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:38:49,511 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:38:49,517 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:38:49,602 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:38:49,705 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:38:49,755 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:38:49,831 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:38:49,864 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:38:49,865 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:38:49,953 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:38:50,271 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:38:50,368 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:38:50,371 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:38:50,372 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:38:50,462 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:38:50,464 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:38:50,471 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:38:50,733 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:38:50,841 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:38:50,848 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:38:50,929 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:38:51,107 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:38:51,256 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:38:51,262 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:38:51,268 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:38:51,274 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:38:51,279 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:38:51,285 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:38:51,349 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:40:50,156 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:40:50,199 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:40:50,200 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:40:56,863 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:40:56,865 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:40:56,886 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:40:56,887 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:40:56,889 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:40:56,890 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:40:56,952 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:40:56,954 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:40:58,078 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:40:58,079 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:40:58,079 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:40:58,123 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:40:58,130 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:40:58,131 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:40:58,396 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:40:58,677 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:40:58,677 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:40:58,678 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:40:58,684 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:40:58,686 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:40:58,686 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:40:58,709 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:40:58,766 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:40:58,916 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:40:59,083 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:40:59,086 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:40:59,204 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:40:59,255 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:40:59,256 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:40:59,309 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:40:59,369 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:40:59,411 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:40:59,411 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:40:59,419 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:40:59,499 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:40:59,599 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:40:59,650 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:40:59,723 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:40:59,759 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:40:59,760 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:40:59,847 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:40:59,937 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:41:00,028 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:41:00,030 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:41:00,031 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:41:00,119 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:41:00,121 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:41:00,127 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:41:00,292 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:41:00,301 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:41:00,302 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:41:00,344 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:41:00,505 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:41:00,643 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:41:00,649 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:41:00,655 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:41:00,662 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:41:00,669 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:41:00,676 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:41:00,684 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:41:00,716 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:41:00,717 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:41:00,722 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:41:31,063 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:41:31,064 - WARNING - La columna 'license' no se encontró en df_cleaning. No se realizó ninguna eliminación.
2025-05-16 23:41:34,087 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:41:34,088 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:41:34,110 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:41:34,112 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:41:34,114 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:41:34,115 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:41:34,260 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:41:34,261 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:41:35,332 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:41:35,332 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:41:35,333 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:41:35,374 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:41:35,381 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:41:35,382 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:41:35,629 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:41:35,894 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:41:35,894 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:41:35,895 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:41:35,901 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:41:35,903 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:41:35,904 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:41:35,911 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:41:35,969 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:41:36,118 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:41:36,274 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:41:36,275 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:41:36,325 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:41:36,375 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:41:36,375 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:41:36,428 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:41:36,482 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:41:36,526 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:41:36,527 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:41:36,533 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:41:36,614 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:41:36,716 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:41:36,766 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:41:36,841 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:41:36,875 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:41:36,876 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:41:36,965 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:41:37,055 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:41:37,145 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:41:37,148 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:41:37,148 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:41:37,244 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:41:37,245 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:41:37,252 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:41:37,432 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:41:37,441 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:41:37,442 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:41:37,482 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:41:37,753 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:41:37,885 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:41:37,891 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:41:37,897 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:41:37,902 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:41:37,909 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:41:37,915 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:41:37,920 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:41:37,952 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:41:37,953 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:41:37,965 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:47:04,575 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:47:04,577 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:47:04,583 - INFO - Para 'availability_365':
2025-05-16 23:47:04,584 - INFO -   - Número de valores < 0: 431
2025-05-16 23:47:04,584 - INFO -     Valores encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:47:04,585 - INFO -   - Número de valores > 366: 2721
2025-05-16 23:47:04,586 - INFO -     Valores encontrados > 366 (primeros 5 únicos): [374, 375, 372, 383, 411]
2025-05-16 23:47:04,603 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 366).
2025-05-16 23:47:04,604 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=366
2025-05-16 23:49:07,841 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:49:07,843 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:49:07,859 - INFO - Para 'availability_365':
2025-05-16 23:49:07,860 - INFO -   - Número de valores < 0: 0
2025-05-16 23:49:07,861 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:49:07,861 - INFO -     Valores encontrados > 365 (primeros 5 únicos): [366]
2025-05-16 23:49:07,877 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:49:07,879 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:49:54,375 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:49:54,377 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:49:54,430 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:49:54,431 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:49:54,435 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:49:54,449 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:49:54,614 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:49:54,615 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:49:55,588 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:49:55,589 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:49:55,590 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:49:55,635 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:49:55,642 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:49:55,643 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:49:55,926 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:49:56,214 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:49:56,215 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:49:56,215 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:49:56,222 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:49:56,223 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:49:56,223 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:49:56,235 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:49:56,294 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:49:56,447 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:49:56,634 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:49:56,635 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:49:56,686 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:49:56,736 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:49:56,736 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:49:56,790 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:49:56,844 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:49:56,888 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:49:56,889 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:49:56,895 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:49:56,978 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:49:57,081 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:49:57,134 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:49:57,217 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:49:57,253 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:49:57,254 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:49:57,348 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:49:57,441 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:49:57,538 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:49:57,541 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:49:57,541 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:49:57,643 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:49:57,644 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:49:57,654 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:49:57,829 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:49:57,841 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:49:57,842 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:49:57,883 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:49:58,053 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:49:58,193 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:49:58,199 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:49:58,204 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:49:58,209 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:49:58,215 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:49:58,219 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:49:58,226 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:49:58,254 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:49:58,254 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:49:58,278 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:49:58,280 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:49:58,285 - INFO - Para 'availability_365':
2025-05-16 23:49:58,285 - INFO -   - Número de valores < 0: 431
2025-05-16 23:49:58,286 - INFO -     Valores encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:49:58,296 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:49:58,299 - INFO -     Valores encontrados > 365 (primeros 5 únicos): [374, 375, 372, 383, 411]
2025-05-16 23:49:58,303 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:49:58,304 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:49:58,316 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:50:10,316 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:50:10,318 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:50:10,321 - INFO - Para 'availability_365':
2025-05-16 23:50:10,322 - INFO -   - Número de valores < 0: 0
2025-05-16 23:50:10,322 - INFO -   - Número de valores > 365: 0
2025-05-16 23:50:10,338 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:50:10,340 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:50:11,929 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:50:11,930 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:50:11,950 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:50:11,951 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:50:11,953 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:50:11,953 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:50:12,024 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:50:12,025 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:50:13,054 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:50:13,055 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:50:13,056 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:50:13,157 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:50:13,215 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:50:13,216 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:50:13,582 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:50:13,856 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:50:13,856 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:50:13,857 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:50:13,863 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:50:13,864 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:50:13,865 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:50:13,881 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:50:13,941 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:50:14,091 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:50:14,251 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:50:14,252 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:50:14,305 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:50:14,358 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:50:14,359 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:50:14,417 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:50:14,474 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:50:14,522 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:50:14,523 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:50:14,530 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:50:14,617 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:50:14,719 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:50:14,771 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:50:14,846 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:50:14,882 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:50:14,883 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:50:14,978 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:50:15,072 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:50:15,164 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:50:15,166 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:50:15,167 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:50:15,258 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:50:15,259 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:50:15,266 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:50:15,436 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:50:15,447 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:50:15,449 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:50:15,488 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:50:15,643 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:50:15,792 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:50:15,814 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:50:15,835 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:50:15,845 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:50:15,866 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:50:15,875 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:50:15,886 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:50:15,928 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:50:15,929 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:50:15,951 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:50:15,952 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:50:15,956 - INFO - Para 'availability_365':
2025-05-16 23:50:15,957 - INFO -   - Número de valores < 0: 431
2025-05-16 23:50:15,958 - INFO -     Valores encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:50:15,958 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:50:15,959 - INFO -     Valores encontrados > 365 (primeros 5 únicos): [374, 375, 372, 383, 411]
2025-05-16 23:50:15,961 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:50:15,962 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:50:15,980 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:50:28,885 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:50:28,887 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:50:28,890 - INFO - Para 'availability_365':
2025-05-16 23:50:28,890 - INFO -   - Número de valores < 0: 0
2025-05-16 23:50:28,891 - INFO -   - Número de valores > 365: 0
2025-05-16 23:50:28,907 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:50:28,908 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:50:38,100 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:50:38,101 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:50:38,104 - INFO - Para 'availability_365':
2025-05-16 23:50:38,105 - INFO -   - Número de valores < 0: 0
2025-05-16 23:50:38,105 - INFO -   - Número de valores > 365: 0
2025-05-16 23:50:38,120 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:50:38,121 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:51:00,845 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:51:00,846 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:51:00,853 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:51:00,855 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:51:00,868 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:51:00,869 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:51:00,957 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:51:00,959 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:51:01,882 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:51:01,883 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:51:01,884 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:51:01,928 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:51:01,935 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:51:01,936 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:51:02,200 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:51:02,482 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:51:02,483 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:51:02,483 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:51:02,488 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:51:02,490 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:51:02,490 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:51:02,501 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:51:02,559 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:51:02,720 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:51:02,872 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:51:02,873 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:51:02,925 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:51:02,975 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:51:02,976 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:51:03,031 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:51:03,085 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:51:03,132 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:51:03,133 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:51:03,139 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:51:03,235 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:51:03,336 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:51:03,387 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:51:03,466 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:51:03,503 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:51:03,504 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:51:03,598 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:51:03,687 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:51:03,778 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:51:03,780 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:51:03,781 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:51:03,873 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:51:03,874 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:51:03,882 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:51:04,050 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:51:04,059 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:51:04,061 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:51:04,099 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:51:04,244 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:51:04,371 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:51:04,377 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:51:04,382 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:51:04,388 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:51:04,393 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:51:04,399 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:51:04,405 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:51:04,440 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:51:04,441 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:51:04,464 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:51:04,465 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:51:04,470 - INFO - Para 'availability_365':
2025-05-16 23:51:04,470 - INFO -   - Número de valores < 0: 431
2025-05-16 23:51:04,471 - INFO -     Valores encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:51:04,471 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:51:04,471 - INFO -     Valores encontrados > 365 (primeros 5 únicos): [374, 375, 372, 383, 411]
2025-05-16 23:51:04,481 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:51:04,488 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:51:04,490 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:51:04,514 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:51:25,568 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:51:25,581 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:51:25,588 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:51:25,589 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:51:25,598 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:51:25,603 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:51:25,656 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:51:25,657 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:51:26,617 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:51:26,618 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:51:26,618 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:51:26,664 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:51:26,670 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:51:26,671 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:51:26,949 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:51:27,298 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:51:27,299 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:51:27,300 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:51:27,307 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:51:27,308 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:51:27,320 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:51:27,327 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:51:27,400 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:51:27,550 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:51:27,954 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:51:27,956 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:51:28,046 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:51:28,098 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:51:28,099 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:51:28,152 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:51:28,207 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:51:28,252 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:51:28,253 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:51:28,261 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:51:28,350 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:51:28,456 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:51:28,509 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:51:28,585 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:51:28,620 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:51:28,622 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:51:28,715 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:51:28,805 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:51:28,899 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:51:28,901 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:51:28,902 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:51:28,995 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:51:28,996 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:51:29,003 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:51:29,173 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:51:29,185 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:51:29,186 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:51:29,225 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:51:29,378 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:51:29,513 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:51:29,519 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:51:29,525 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:51:29,531 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:51:29,536 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:51:29,543 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:51:29,549 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:51:29,579 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:51:29,580 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:51:29,600 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:51:29,601 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:51:29,605 - INFO - Para 'availability_365':
2025-05-16 23:51:29,606 - INFO -   - Número de valores < 0: 431
2025-05-16 23:51:29,607 - INFO -     Valores encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:51:29,607 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:51:29,608 - INFO -     Valores encontrados > 365 (primeros 5 únicos): [374, 375, 372, 383, 411]
2025-05-16 23:51:29,608 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:51:29,611 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:51:29,612 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:51:29,618 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:52:01,186 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:52:01,187 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:52:01,194 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:52:01,195 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:52:01,197 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:52:01,198 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:52:01,261 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:52:01,263 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:52:02,194 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:52:02,195 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:52:02,196 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:52:02,242 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:52:02,248 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:52:02,249 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:52:02,508 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:52:02,789 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:52:02,790 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:52:02,791 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:52:02,796 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:52:02,798 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:52:02,798 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:52:02,825 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:52:02,882 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:52:03,032 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:52:03,348 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:52:03,350 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:52:03,413 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:52:03,464 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:52:03,465 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:52:03,520 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:52:03,576 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:52:03,625 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:52:03,626 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:52:03,632 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:52:03,718 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:52:03,822 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:52:03,872 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:52:03,948 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:52:03,984 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:52:03,985 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:52:04,076 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:52:04,166 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:52:04,259 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:52:04,261 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:52:04,262 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:52:04,357 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:52:04,358 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:52:04,366 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:52:04,538 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:52:04,549 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:52:04,550 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:52:04,587 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:52:04,737 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:52:04,870 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:52:04,876 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:52:04,882 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:52:04,887 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:52:04,893 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:52:04,899 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:52:04,904 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:52:04,934 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:52:04,935 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:52:33,829 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:52:33,831 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:52:33,901 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:52:33,902 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:52:33,916 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:52:33,928 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:52:34,032 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:52:34,034 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:52:35,050 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:52:35,051 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:52:35,052 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:52:35,096 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:52:35,102 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:52:35,103 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:52:35,354 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:52:35,620 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:52:35,621 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:52:35,621 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:52:35,628 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:52:35,630 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:52:35,630 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:52:35,657 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:52:35,716 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:52:35,882 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:52:36,040 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:52:36,042 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:52:36,094 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:52:36,146 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:52:36,146 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:52:36,203 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:52:36,261 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:52:36,321 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:52:36,329 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:52:36,348 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:52:36,506 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:52:36,612 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:52:36,666 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:52:36,749 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:52:36,784 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:52:36,785 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:52:36,880 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:52:36,970 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:52:37,064 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:52:37,067 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:52:37,067 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:52:37,164 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:52:37,164 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:52:37,171 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:52:37,345 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:52:37,355 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:52:37,357 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:52:37,396 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:52:37,544 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:52:37,677 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:52:37,683 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:52:37,689 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:52:37,695 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:52:37,700 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:52:37,706 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:52:37,712 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:52:37,743 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:52:37,744 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:52:37,765 - INFO - Celda 10: Analizando y corrigiendo valores fuera de rango en 'availability_365'.
2025-05-16 23:52:37,766 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:52:37,770 - INFO - Para 'availability_365':
2025-05-16 23:52:37,771 - INFO -   - Número de valores < 0: 431
2025-05-16 23:52:37,772 - INFO -     Valores encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:52:37,772 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:52:37,773 - INFO -     Valores encontrados > 365 (primeros 5 únicos): [374, 375, 372, 383, 411]
2025-05-16 23:52:37,774 - INFO -     Valores encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:52:37,774 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:52:37,775 - INFO -     Valores encontrados > 365 (primeros 5 únicos): [374, 375, 372, 383, 411]
2025-05-16 23:52:37,777 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:52:37,778 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:52:37,784 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:54:21,646 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:54:21,648 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:54:21,667 - INFO - Para 'availability_365':
2025-05-16 23:54:21,668 - INFO -   - Número de valores < 0: 0
2025-05-16 23:54:21,668 - INFO -   - Número de valores > 365: 0
2025-05-16 23:55:05,674 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:55:05,674 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:55:05,693 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:55:05,694 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:55:05,695 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:55:05,703 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:55:05,762 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:55:05,764 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:55:06,799 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:55:06,800 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:55:06,801 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:55:06,846 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:55:06,854 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:55:06,855 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:55:07,166 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:55:07,450 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:55:07,451 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:55:07,451 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:55:07,457 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:55:07,459 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:55:07,460 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:55:07,483 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:55:07,571 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:55:07,725 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:55:07,891 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:55:07,892 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:55:07,943 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:55:07,995 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:55:07,996 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:55:08,050 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:55:08,106 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:55:08,153 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:55:08,153 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:55:08,160 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:55:08,263 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:55:08,406 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:55:08,495 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:55:08,590 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:55:08,646 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:55:08,647 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:55:08,752 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:55:08,854 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:55:08,954 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:55:08,957 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:55:08,957 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:55:09,057 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:55:09,058 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:55:09,067 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:55:09,247 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:55:09,258 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:55:09,260 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:55:09,300 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:55:09,449 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:55:09,588 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:55:09,594 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:55:09,601 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:55:09,608 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:55:09,614 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:55:09,619 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:55:09,626 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:55:09,656 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:55:09,657 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:55:09,665 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:55:09,666 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:55:09,685 - INFO - Para 'availability_365':
2025-05-16 23:55:09,685 - INFO -   - Número de valores < 0: 431
2025-05-16 23:55:09,686 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:55:09,687 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:55:09,688 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417, 425, 395, 410, 388, 366, 378, 389, 373, 426, 396]
2025-05-16 23:55:09,696 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-16 23:55:09,700 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:55:09,715 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:55:09,727 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:55:54,896 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:55:54,904 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:55:54,917 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:55:54,924 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:55:54,934 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:55:54,942 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:55:55,018 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:55:55,020 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:55:56,018 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:55:56,019 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:55:56,020 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:55:56,065 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:55:56,073 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:55:56,074 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:55:56,352 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:55:56,623 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:55:56,624 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:55:56,624 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:55:56,630 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:55:56,631 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:55:56,632 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:55:56,673 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:55:56,731 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:55:56,882 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:55:57,051 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:55:57,052 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:55:57,105 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:55:57,156 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:55:57,157 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:55:57,211 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:55:57,265 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:55:57,311 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:55:57,311 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:55:57,318 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:55:57,400 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:55:57,503 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:55:57,554 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:55:57,628 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:55:57,665 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:55:57,666 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:55:57,759 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:55:57,849 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:55:57,944 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:55:57,946 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:55:57,947 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:55:58,040 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:55:58,041 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:55:58,048 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:55:58,381 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:55:58,398 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:55:58,399 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:55:58,438 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:55:58,592 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:55:58,740 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:55:58,746 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:55:58,752 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:55:58,758 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:55:58,764 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:55:58,771 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:55:58,777 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:55:58,809 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:55:58,810 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:55:58,819 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:55:58,821 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:55:58,850 - INFO - Para 'availability_365':
2025-05-16 23:55:58,850 - INFO -   - Número de valores < 0: 431
2025-05-16 23:55:58,851 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:55:58,852 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:55:58,852 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-16 23:55:58,860 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-16 23:55:58,865 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:55:58,866 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:55:58,874 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:56:21,498 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:56:21,499 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:56:21,506 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:56:21,507 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:56:21,508 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:56:21,509 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:56:21,576 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:56:21,577 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:56:22,539 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:56:22,539 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:56:22,540 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:56:22,582 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:56:22,588 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:56:22,589 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:56:22,845 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:56:23,197 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:56:23,198 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:56:23,198 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:56:23,205 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:56:23,206 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:56:23,207 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:56:23,229 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:56:23,288 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:56:23,440 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:56:23,599 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:56:23,601 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:56:23,654 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:56:23,707 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:56:23,708 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:56:23,763 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:56:23,819 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:56:23,864 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:56:23,865 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:56:23,872 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:56:23,955 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:56:24,063 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:56:24,121 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:56:24,201 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:56:24,237 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:56:24,238 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:56:24,329 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:56:24,431 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:56:24,542 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:56:24,544 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:56:24,545 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:56:24,651 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:56:24,652 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:56:24,661 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:56:24,861 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:56:24,874 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:56:24,875 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:56:24,931 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:56:25,118 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:56:25,254 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:56:25,260 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:56:25,266 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:56:25,272 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:56:25,277 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:56:25,283 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:56:25,290 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:56:25,320 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:56:25,321 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:56:25,328 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:56:25,329 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:56:25,346 - INFO - Para 'availability_365':
2025-05-16 23:56:25,346 - INFO -   - Número de valores < 0: 431
2025-05-16 23:56:25,347 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:56:25,347 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:56:25,348 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-16 23:56:25,355 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-16 23:56:25,358 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:56:25,360 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:56:25,368 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:56:25,370 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:56:25,373 - INFO - Para 'availability_365':
2025-05-16 23:56:25,373 - INFO -   - Número de valores < 0: 0
2025-05-16 23:56:25,374 - INFO -   - Número de valores > 365: 0
2025-05-16 23:56:25,379 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:58:08,091 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-16 23:58:08,095 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:58:08,097 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:58:48,851 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:58:48,851 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:58:48,871 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:58:48,874 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:58:48,887 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:58:48,888 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:58:48,948 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:58:48,949 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:58:49,976 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:58:49,976 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:58:49,977 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:58:50,023 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:58:50,030 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:58:50,031 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:58:50,414 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:58:50,684 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:58:50,685 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:58:50,685 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:58:50,692 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:58:50,693 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:58:50,694 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:58:50,715 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:58:50,779 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:58:50,943 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:58:51,105 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:58:51,106 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:58:51,160 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:58:51,212 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:58:51,214 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:58:51,271 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:58:51,327 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:58:51,376 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:58:51,377 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:58:51,384 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:58:51,469 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:58:51,572 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:58:51,625 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:58:51,702 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:58:51,743 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:58:51,744 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:58:51,849 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:58:51,966 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:58:52,069 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:58:52,072 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:58:52,073 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:58:52,264 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:58:52,268 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:58:52,279 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:58:52,474 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:58:52,489 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:58:52,490 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:58:52,535 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:58:52,705 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:58:52,841 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:58:52,847 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:58:52,854 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:58:52,860 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:58:52,866 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:58:52,872 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:58:52,877 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:58:52,908 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:58:52,908 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:58:52,917 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:58:52,918 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:58:52,935 - INFO - Para 'availability_365':
2025-05-16 23:58:52,936 - INFO -   - Número de valores < 0: 431
2025-05-16 23:58:52,936 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:58:52,937 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:58:52,938 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-16 23:58:52,960 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-16 23:58:52,977 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:58:52,979 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:58:52,989 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:58:52,991 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:58:52,995 - INFO - Para 'availability_365':
2025-05-16 23:58:52,995 - INFO -   - Número de valores < 0: 0
2025-05-16 23:58:52,996 - INFO -   - Número de valores > 365: 0
2025-05-16 23:58:53,004 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-16 23:58:53,009 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:58:53,010 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:58:53,017 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:59:07,522 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-16 23:59:07,534 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-16 23:59:07,557 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:59:07,559 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-16 23:59:07,573 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-16 23:59:07,574 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-16 23:59:07,632 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-16 23:59:07,633 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-16 23:59:08,811 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-16 23:59:08,812 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-16 23:59:08,813 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-16 23:59:08,861 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-16 23:59:08,870 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-16 23:59:08,871 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-16 23:59:09,147 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-16 23:59:09,449 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-16 23:59:09,449 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-16 23:59:09,450 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-16 23:59:09,456 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-16 23:59:09,458 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-16 23:59:09,459 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-16 23:59:09,476 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:59:09,535 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-16 23:59:09,687 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-16 23:59:09,854 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-16 23:59:09,856 - INFO - Procesando 'host_identity_verified'.
2025-05-16 23:59:09,909 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-16 23:59:09,960 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-16 23:59:09,961 - INFO - Procesando 'instant_bookable'.
2025-05-16 23:59:10,019 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-16 23:59:10,073 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-16 23:59:10,120 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-16 23:59:10,121 - INFO - Transformaciones de tipo booleano completadas.
2025-05-16 23:59:10,127 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-16 23:59:10,223 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-16 23:59:10,325 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-16 23:59:10,376 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-16 23:59:10,454 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-16 23:59:10,492 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-16 23:59:10,493 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-16 23:59:10,599 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-16 23:59:10,690 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-16 23:59:10,788 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-16 23:59:10,791 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-16 23:59:10,791 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-16 23:59:10,889 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-16 23:59:10,890 - INFO - Transformaciones de tipo categórico completadas.
2025-05-16 23:59:10,899 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-16 23:59:11,079 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-16 23:59:11,090 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-16 23:59:11,091 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-16 23:59:11,129 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-16 23:59:11,292 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-16 23:59:11,436 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-16 23:59:11,443 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-16 23:59:11,449 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-16 23:59:11,456 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-16 23:59:11,462 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-16 23:59:11,469 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-16 23:59:11,476 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-16 23:59:11,506 - INFO - Columna 'license' eliminada exitosamente.
2025-05-16 23:59:11,507 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-16 23:59:11,515 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:59:11,516 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:59:11,533 - INFO - Para 'availability_365':
2025-05-16 23:59:11,534 - INFO -   - Número de valores < 0: 431
2025-05-16 23:59:11,534 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-16 23:59:11,535 - INFO -   - Número de valores > 365: 2754
2025-05-16 23:59:11,535 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-16 23:59:11,542 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-16 23:59:11,545 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:59:11,559 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:59:11,568 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-16 23:59:11,569 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-16 23:59:11,573 - INFO - Para 'availability_365':
2025-05-16 23:59:11,573 - INFO -   - Número de valores < 0: 0
2025-05-16 23:59:11,574 - INFO -   - Número de valores > 365: 0
2025-05-16 23:59:11,581 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-16 23:59:11,585 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-16 23:59:11,586 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-16 23:59:11,592 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:04:33,798 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:04:33,799 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:04:33,809 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:04:33,810 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:04:33,811 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:04:33,812 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:04:33,874 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:04:33,875 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:04:34,794 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:04:34,794 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:04:34,795 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:04:34,838 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:04:34,844 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:04:34,845 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:04:35,094 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:04:35,364 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:04:35,365 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:04:35,365 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:04:35,373 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:04:35,374 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:04:35,374 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:04:35,386 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:04:35,441 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:04:35,596 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:04:35,778 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:04:35,779 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:04:35,831 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:04:35,882 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:04:35,883 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:04:35,938 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:04:35,991 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:04:36,037 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:04:36,038 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:04:36,044 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:04:36,128 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:04:36,230 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:04:36,282 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:04:36,359 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:04:36,393 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:04:36,394 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:04:36,482 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:04:36,572 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:04:36,663 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:04:36,666 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:04:36,667 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:04:36,790 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:04:36,791 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:04:36,798 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:04:36,972 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:04:36,993 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:04:36,994 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:04:37,031 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:04:37,171 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:04:37,297 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:04:37,303 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:04:37,308 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:04:37,314 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:04:37,319 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:04:37,325 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:04:37,331 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:04:37,360 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:04:37,360 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:04:37,368 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:04:37,370 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:04:37,386 - INFO - Para 'availability_365':
2025-05-17 00:04:37,387 - INFO -   - Número de valores < 0: 431
2025-05-17 00:04:37,387 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:04:37,387 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:04:37,388 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:04:37,395 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:04:37,399 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-17 00:04:37,400 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-17 00:04:37,409 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:04:37,411 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:04:37,413 - INFO - Para 'availability_365':
2025-05-17 00:04:37,414 - INFO -   - Número de valores < 0: 0
2025-05-17 00:04:37,414 - INFO -   - Número de valores > 365: 0
2025-05-17 00:04:37,420 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:04:37,424 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:04:37,426 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:04:37,489 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:05:40,560 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:05:40,561 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:05:40,568 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:05:40,569 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:05:40,571 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:05:40,572 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:05:40,626 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:05:40,628 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:05:41,526 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:05:41,526 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:05:41,527 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:05:41,571 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:05:41,578 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:05:41,579 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:05:41,840 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:05:42,122 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:05:42,122 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:05:42,123 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:05:42,128 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:05:42,129 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:05:42,130 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:05:42,141 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:05:42,198 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:05:42,346 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:05:42,533 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:05:42,535 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:05:42,607 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:05:42,671 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:05:42,672 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:05:42,730 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:05:42,786 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:05:42,832 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:05:42,832 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:05:42,838 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:05:42,923 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:05:43,025 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:05:43,078 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:05:43,151 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:05:43,186 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:05:43,187 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:05:43,278 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:05:43,371 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:05:43,465 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:05:43,468 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:05:43,468 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:05:43,562 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:05:43,563 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:05:43,571 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:05:43,747 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:05:43,756 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:05:43,757 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:05:43,796 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:05:43,941 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:05:44,068 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:05:44,074 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:05:44,079 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:05:44,085 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:05:44,090 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:05:44,096 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:05:44,103 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:05:44,131 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:05:44,132 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:05:44,141 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:05:44,145 - INFO - Valores en 'availability_365' corregidos (clipping entre 0 y 365).
2025-05-17 00:05:44,146 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=0, Max=365
2025-05-17 00:05:44,157 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:05:44,158 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:05:44,178 - INFO - Para 'availability_365':
2025-05-17 00:05:44,179 - INFO -   - Número de valores < 0: 0
2025-05-17 00:05:44,179 - INFO -   - Número de valores > 365: 0
2025-05-17 00:05:44,187 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:05:44,192 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:05:44,193 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:05:44,255 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:06:02,030 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:06:02,031 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:06:02,040 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:06:02,041 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:06:02,042 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:06:02,043 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:06:02,106 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:06:02,107 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:06:03,166 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:06:03,167 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:06:03,168 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:06:03,219 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:06:03,227 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:06:03,228 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:06:03,498 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:06:03,806 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:06:03,807 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:06:03,807 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:06:03,813 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:06:03,814 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:06:03,815 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:06:03,825 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:06:03,884 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:06:04,036 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:06:04,199 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:06:04,200 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:06:04,252 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:06:04,304 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:06:04,304 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:06:04,360 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:06:04,418 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:06:04,472 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:06:04,472 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:06:04,479 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:06:04,574 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:06:04,686 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:06:04,742 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:06:04,828 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:06:04,863 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:06:04,864 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:06:04,956 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:06:05,046 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:06:05,141 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:06:05,144 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:06:05,145 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:06:05,255 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:06:05,256 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:06:05,264 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:06:05,465 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:06:05,474 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:06:05,476 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:06:05,531 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:06:05,677 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:06:05,803 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:06:05,809 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:06:05,815 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:06:05,820 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:06:05,826 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:06:05,832 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:06:05,840 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:06:05,893 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:06:05,894 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:06:05,917 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:06:05,920 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:06:05,942 - INFO - Para 'availability_365':
2025-05-17 00:06:05,943 - INFO -   - Número de valores < 0: 431
2025-05-17 00:06:05,944 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:06:05,944 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:06:05,945 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:06:05,952 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:06:05,958 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:06:05,959 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:06:06,040 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:07:15,457 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:07:15,457 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:07:15,466 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:07:15,466 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:07:15,468 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:07:15,468 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:07:15,548 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:07:15,549 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:07:16,510 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:07:16,511 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:07:16,512 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:07:16,560 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:07:16,569 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:07:16,570 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:07:16,838 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:07:17,129 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:07:17,130 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:07:17,131 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:07:17,137 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:07:17,139 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:07:17,139 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:07:17,169 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:07:17,227 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:07:17,379 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:07:17,537 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:07:17,538 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:07:17,590 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:07:17,642 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:07:17,643 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:07:17,699 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:07:17,754 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:07:17,802 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:07:17,803 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:07:17,809 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:07:17,901 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:07:18,005 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:07:18,062 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:07:18,136 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:07:18,172 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:07:18,173 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:07:18,274 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:07:18,372 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:07:18,485 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:07:18,489 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:07:18,490 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:07:18,609 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:07:18,610 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:07:18,619 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:07:18,789 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:07:18,798 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:07:18,799 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:07:18,838 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:07:18,984 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:07:19,111 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:07:19,117 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:07:19,122 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:07:19,128 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:07:19,133 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:07:19,138 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:07:19,159 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:07:19,191 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:07:19,191 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:07:19,200 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:07:19,202 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:07:19,219 - INFO - Para 'availability_365':
2025-05-17 00:07:19,219 - INFO -   - Número de valores < 0: 431
2025-05-17 00:07:19,220 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:07:19,220 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:07:19,221 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:07:19,227 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:07:19,232 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:07:19,233 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:07:19,299 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:08:03,703 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:08:03,704 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:08:03,713 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:08:03,714 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:08:03,716 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:08:03,716 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:08:03,779 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:08:03,780 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:08:04,667 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:08:04,668 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:08:04,669 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:08:04,719 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:08:04,727 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:08:04,729 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:08:04,996 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:08:05,266 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:08:05,267 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:08:05,267 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:08:05,272 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:08:05,273 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:08:05,274 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:08:05,297 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:08:05,359 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:08:05,514 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:08:05,671 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:08:05,672 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:08:05,726 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:08:05,778 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:08:05,779 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:08:05,834 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:08:05,889 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:08:05,952 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:08:05,953 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:08:05,966 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:08:06,082 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:08:06,184 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:08:06,236 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:08:06,312 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:08:06,347 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:08:06,349 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:08:06,440 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:08:06,533 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:08:06,626 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:08:06,629 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:08:06,630 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:08:06,727 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:08:06,728 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:08:06,736 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:08:06,922 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:08:06,933 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:08:06,934 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:08:06,973 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:08:07,127 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:08:07,276 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:08:07,283 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:08:07,288 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:08:07,294 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:08:07,299 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:08:07,304 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:08:07,311 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:08:07,344 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:08:07,344 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:08:07,352 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:08:07,354 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:08:07,371 - INFO - Para 'availability_365':
2025-05-17 00:08:07,372 - INFO -   - Número de valores < 0: 431
2025-05-17 00:08:07,372 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:08:07,373 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:08:07,374 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:08:07,381 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:08:07,386 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:08:07,387 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:08:07,458 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:08:07,460 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:08:07,463 - INFO - Para 'minimum_nights':
2025-05-17 00:08:07,464 - INFO -   - Número de valores < 1: 13
2025-05-17 00:08:07,464 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:08:07,465 - INFO -   - Número de valores > 365: 35
2025-05-17 00:08:07,465 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500, 480, 999, 400, 954, 5645, 2645, 458, 825]
2025-05-17 00:08:07,472 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:09:08,422 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:09:08,426 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:09:08,427 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:09:24,494 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:09:24,495 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:09:24,504 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:09:24,506 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:09:24,508 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:09:24,509 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:09:24,588 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:09:24,589 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:09:25,581 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:09:25,582 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:09:25,583 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:09:25,626 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:09:25,632 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:09:25,633 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:09:25,879 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:09:26,145 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:09:26,146 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:09:26,146 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:09:26,151 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:09:26,152 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:09:26,153 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:09:26,160 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:09:26,216 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:09:26,362 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:09:26,514 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:09:26,515 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:09:26,565 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:09:26,615 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:09:26,616 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:09:26,669 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:09:26,723 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:09:26,769 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:09:26,770 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:09:26,777 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:09:26,862 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:09:26,967 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:09:27,018 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:09:27,095 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:09:27,131 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:09:27,132 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:09:27,223 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:09:27,326 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:09:27,462 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:09:27,466 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:09:27,468 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:09:27,580 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:09:27,581 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:09:27,588 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:09:27,761 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:09:27,772 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:09:27,773 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:09:27,814 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:09:27,968 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:09:28,096 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:09:28,102 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:09:28,108 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:09:28,114 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:09:28,118 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:09:28,124 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:09:28,130 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:09:28,160 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:09:28,160 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:09:28,167 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:09:28,169 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:09:28,185 - INFO - Para 'availability_365':
2025-05-17 00:09:28,186 - INFO -   - Número de valores < 0: 431
2025-05-17 00:09:28,186 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:09:28,186 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:09:28,187 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:09:28,195 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:09:28,199 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:09:28,200 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:09:28,209 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:09:28,210 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:09:28,213 - INFO - Para 'minimum_nights':
2025-05-17 00:09:28,214 - INFO -   - Número de valores < 1: 13
2025-05-17 00:09:28,214 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:09:28,215 - INFO -   - Número de valores > 365: 35
2025-05-17 00:09:28,215 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:09:28,222 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:09:28,226 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:09:28,227 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:09:28,295 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:26:21,237 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:26:21,238 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:26:21,245 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:26:21,246 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:26:21,248 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:26:21,249 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:26:21,339 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:26:21,342 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:26:22,215 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:26:22,216 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:26:22,217 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:26:22,260 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:26:22,266 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:26:22,267 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:26:22,525 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:26:22,811 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:26:22,811 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:26:22,812 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:26:22,818 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:26:22,819 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:26:22,820 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:26:22,832 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:26:22,888 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:26:23,038 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:26:23,194 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:26:23,195 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:26:23,246 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:26:23,297 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:26:23,298 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:26:23,352 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:26:23,407 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:26:23,453 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:26:23,453 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:26:23,460 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:26:23,546 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:26:23,651 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:26:23,704 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:26:23,779 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:26:23,814 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:26:23,815 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:26:23,909 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:26:23,999 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:26:24,093 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:26:24,095 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:26:24,096 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:26:24,188 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:26:24,189 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:26:24,195 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:26:24,365 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:26:24,376 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:26:24,377 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:26:24,418 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:26:24,568 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:26:24,696 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:26:24,701 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:26:24,708 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:26:24,713 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:26:24,717 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:26:24,723 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:26:24,728 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:26:24,759 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:26:24,759 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:26:24,767 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:26:24,768 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:26:24,784 - INFO - Para 'availability_365':
2025-05-17 00:26:24,785 - INFO -   - Número de valores < 0: 431
2025-05-17 00:26:24,786 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:26:24,786 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:26:24,787 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:26:24,795 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:26:24,799 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:26:24,800 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:26:24,808 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:26:24,810 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:26:24,813 - INFO - Para 'minimum_nights':
2025-05-17 00:26:24,813 - INFO -   - Número de valores < 1: 13
2025-05-17 00:26:24,814 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:26:24,814 - INFO -   - Número de valores > 365: 35
2025-05-17 00:26:24,815 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:26:24,821 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:26:24,825 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:26:24,826 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:26:24,889 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:26:24,891 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:26:24,915 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:26:24,916 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:26:24,939 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:26:24,947 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:29:01,567 - INFO - Celda 12.2: Iniciando imputación de nulos para 'neighbourhood'.
2025-05-17 00:29:01,569 - INFO - Nulos en 'neighbourhood' ANTES de la imputación: 0
2025-05-17 00:29:01,569 - INFO - No hay nulos que imputar en 'neighbourhood'.
2025-05-17 00:29:10,404 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:29:10,405 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:29:10,412 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:29:10,413 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:29:10,415 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:29:10,416 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:29:10,471 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:29:10,473 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:29:11,452 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:29:11,453 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:29:11,454 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:29:11,500 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:29:11,509 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:29:11,510 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:29:11,771 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:29:12,070 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:29:12,071 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:29:12,071 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:29:12,078 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:29:12,079 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:29:12,080 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:29:12,101 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:29:12,159 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:29:12,314 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:29:12,478 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:29:12,479 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:29:12,531 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:29:12,581 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:29:12,582 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:29:12,636 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:29:12,690 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:29:12,748 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:29:12,749 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:29:12,761 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:29:12,891 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:29:12,993 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:29:13,046 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:29:13,122 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:29:13,156 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:29:13,157 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:29:13,246 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:29:13,333 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:29:13,424 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:29:13,427 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:29:13,427 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:29:13,522 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:29:13,523 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:29:13,530 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:29:13,702 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:29:13,712 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:29:13,713 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:29:13,751 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:29:13,898 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:29:14,024 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:29:14,030 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:29:14,036 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:29:14,042 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:29:14,047 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:29:14,052 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:29:14,059 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:29:14,089 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:29:14,090 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:29:14,097 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:29:14,099 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:29:14,115 - INFO - Para 'availability_365':
2025-05-17 00:29:14,116 - INFO -   - Número de valores < 0: 431
2025-05-17 00:29:14,116 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:29:14,116 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:29:14,117 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:29:14,123 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:29:14,128 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:29:14,129 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:29:14,138 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:29:14,139 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:29:14,142 - INFO - Para 'minimum_nights':
2025-05-17 00:29:14,143 - INFO -   - Número de valores < 1: 13
2025-05-17 00:29:14,143 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:29:14,144 - INFO -   - Número de valores > 365: 35
2025-05-17 00:29:14,144 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:29:14,150 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:29:14,155 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:29:14,156 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:29:14,221 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:29:14,223 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:29:14,243 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:29:14,244 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:29:14,262 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:29:14,273 - INFO - Celda 12.2: Iniciando imputación de nulos para 'neighbourhood'.
2025-05-17 00:29:14,274 - INFO - Nulos en 'neighbourhood' ANTES de la imputación: 0
2025-05-17 00:29:14,275 - INFO - No hay nulos que imputar en 'neighbourhood'.
2025-05-17 00:29:14,281 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:29:49,763 - INFO - Celda 12.2: Iniciando imputación de nulos para 'neighbourhood'.
2025-05-17 00:29:49,766 - INFO - Nulos en 'neighbourhood' ANTES de la imputación: 0
2025-05-17 00:29:49,766 - INFO - No hay nulos que imputar en 'neighbourhood'.
2025-05-17 00:30:29,407 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:30:29,456 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:31:01,245 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:31:01,246 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:31:01,252 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:31:01,253 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:31:01,255 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:31:01,255 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:31:01,335 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:31:01,341 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:31:02,250 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:31:02,250 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:31:02,251 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:31:02,302 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:31:02,312 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:31:02,314 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:31:02,577 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:31:02,851 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:31:02,852 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:31:02,853 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:31:02,858 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:31:02,859 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:31:02,859 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:31:02,879 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:31:02,935 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:31:03,083 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:31:03,235 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:31:03,236 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:31:03,288 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:31:03,340 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:31:03,340 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:31:03,394 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:31:03,448 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:31:03,492 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:31:03,493 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:31:03,499 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:31:03,584 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:31:03,686 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:31:03,738 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:31:03,811 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:31:03,845 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:31:03,846 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:31:03,937 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:31:04,028 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:31:04,122 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:31:04,124 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:31:04,125 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:31:04,219 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:31:04,221 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:31:04,228 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:31:04,403 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:31:04,414 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:31:04,415 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:31:04,453 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:31:04,597 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:31:04,722 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:31:04,730 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:31:04,737 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:31:04,742 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:31:04,748 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:31:04,753 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:31:04,759 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:31:04,790 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:31:04,791 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:31:04,799 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:31:04,800 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:31:04,817 - INFO - Para 'availability_365':
2025-05-17 00:31:04,818 - INFO -   - Número de valores < 0: 431
2025-05-17 00:31:04,818 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:31:04,819 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:31:04,819 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:31:04,824 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:31:04,830 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:31:04,831 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:31:04,838 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:31:04,839 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:31:04,843 - INFO - Para 'minimum_nights':
2025-05-17 00:31:04,844 - INFO -   - Número de valores < 1: 13
2025-05-17 00:31:04,845 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:31:04,845 - INFO -   - Número de valores > 365: 35
2025-05-17 00:31:04,846 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:31:04,852 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:31:04,855 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:31:04,856 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:31:04,921 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:31:04,923 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:31:04,948 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:31:04,949 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:31:04,969 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:31:04,977 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:31:05,031 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:31:05,036 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:31:19,439 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:31:19,441 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:31:19,456 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:31:19,458 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:31:19,461 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:31:19,463 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:31:19,551 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:31:19,556 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:31:20,513 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:31:20,513 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:31:20,514 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:31:20,564 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:31:20,571 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:31:20,572 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:31:20,818 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:31:21,089 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:31:21,090 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:31:21,090 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:31:21,096 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:31:21,097 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:31:21,098 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:31:21,133 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:31:21,190 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:31:21,340 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:31:21,498 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:31:21,499 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:31:21,551 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:31:21,601 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:31:21,602 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:31:21,655 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:31:21,710 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:31:21,756 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:31:21,757 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:31:21,763 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:31:21,846 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:31:21,947 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:31:21,998 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:31:22,070 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:31:22,118 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:31:22,120 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:31:22,243 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:31:22,331 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:31:22,423 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:31:22,426 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:31:22,427 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:31:22,522 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:31:22,522 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:31:22,530 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:31:22,703 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:31:22,714 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:31:22,715 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:31:22,752 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:31:22,893 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:31:23,016 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:31:23,022 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:31:23,028 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:31:23,033 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:31:23,038 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:31:23,044 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:31:23,050 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:31:23,081 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:31:23,082 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:31:23,092 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:31:23,093 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:31:23,108 - INFO - Para 'availability_365':
2025-05-17 00:31:23,109 - INFO -   - Número de valores < 0: 431
2025-05-17 00:31:23,110 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:31:23,111 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:31:23,112 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:31:23,117 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:31:23,121 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:31:23,122 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:31:23,130 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:31:23,131 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:31:23,134 - INFO - Para 'minimum_nights':
2025-05-17 00:31:23,135 - INFO -   - Número de valores < 1: 13
2025-05-17 00:31:23,135 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:31:23,136 - INFO -   - Número de valores > 365: 35
2025-05-17 00:31:23,136 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:31:23,141 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:31:23,146 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:31:23,148 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:31:23,211 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:31:23,213 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:31:23,233 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:31:23,234 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:31:23,252 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:31:23,259 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:31:23,299 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:31:23,304 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:34:21,520 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:34:21,521 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:34:21,529 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:34:21,530 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:34:21,531 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:34:21,532 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:34:21,584 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:34:21,585 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:34:22,590 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:34:22,591 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:34:22,592 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:34:22,636 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:34:22,643 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:34:22,645 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:34:22,908 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:34:23,192 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:34:23,193 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:34:23,194 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:34:23,201 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:34:23,202 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:34:23,203 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:34:23,214 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:34:23,282 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:34:23,450 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:34:23,643 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:34:23,645 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:34:23,746 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:34:23,826 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:34:23,828 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:34:23,934 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:34:24,012 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:34:24,060 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:34:24,061 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:34:24,068 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:34:24,159 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:34:24,272 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:34:24,324 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:34:24,400 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:34:24,439 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:34:24,441 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:34:24,559 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:34:24,652 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:34:24,750 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:34:24,753 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:34:24,754 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:34:24,872 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:34:24,873 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:34:24,885 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:34:25,057 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:34:25,067 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:34:25,069 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:34:25,109 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:34:25,273 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:34:25,406 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:34:25,414 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:34:25,420 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:34:25,426 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:34:25,432 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:34:25,438 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:34:25,445 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:34:25,476 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:34:25,477 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:34:25,486 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:34:25,487 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:34:25,505 - INFO - Para 'availability_365':
2025-05-17 00:34:25,506 - INFO -   - Número de valores < 0: 431
2025-05-17 00:34:25,507 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:34:25,507 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:34:25,508 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:34:25,515 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:34:25,519 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:34:25,520 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:34:25,528 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:34:25,530 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:34:25,533 - INFO - Para 'minimum_nights':
2025-05-17 00:34:25,534 - INFO -   - Número de valores < 1: 13
2025-05-17 00:34:25,535 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:34:25,535 - INFO -   - Número de valores > 365: 35
2025-05-17 00:34:25,536 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:34:25,543 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:34:25,547 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:34:25,548 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:34:25,619 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:34:25,622 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:34:25,655 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:34:25,656 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:34:25,685 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:34:25,699 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:34:25,765 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:34:25,783 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:35:03,603 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:35:03,604 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:35:03,612 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:35:03,613 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:35:03,614 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:35:03,615 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:35:03,664 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:35:03,666 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:35:04,561 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:35:04,562 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:35:04,563 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:35:04,606 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:35:04,613 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:35:04,614 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:35:04,864 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:35:05,132 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:35:05,133 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:35:05,133 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:35:05,138 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:35:05,140 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:35:05,141 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:35:05,148 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:35:05,204 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:35:05,363 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:35:05,526 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:35:05,528 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:35:05,582 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:35:05,633 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:35:05,634 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:35:05,687 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:35:05,745 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:35:05,791 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:35:05,792 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:35:05,798 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:35:05,881 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:35:05,981 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:35:06,033 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:35:06,106 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:35:06,139 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:35:06,140 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:35:06,236 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:35:06,352 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:35:06,444 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:35:06,446 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:35:06,447 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:35:06,542 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:35:06,543 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:35:06,551 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:35:06,720 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:35:06,730 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:35:06,731 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:35:06,769 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:35:06,912 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:35:07,037 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:35:07,042 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:35:07,048 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:35:07,053 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:35:07,058 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:35:07,064 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:35:07,069 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:35:07,099 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:35:07,100 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:35:07,107 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:35:07,109 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:35:07,124 - INFO - Para 'availability_365':
2025-05-17 00:35:07,125 - INFO -   - Número de valores < 0: 431
2025-05-17 00:35:07,126 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:35:07,126 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:35:07,127 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:35:07,132 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:35:07,136 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:35:07,137 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:35:07,146 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:35:07,147 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:35:07,151 - INFO - Para 'minimum_nights':
2025-05-17 00:35:07,151 - INFO -   - Número de valores < 1: 13
2025-05-17 00:35:07,151 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:35:07,152 - INFO -   - Número de valores > 365: 35
2025-05-17 00:35:07,152 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:35:07,158 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:35:07,162 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:35:07,163 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:35:07,229 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:35:07,230 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:35:07,249 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:35:07,250 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:35:07,269 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:35:07,277 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:35:07,342 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:35:07,358 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:37:45,388 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:37:45,389 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:37:45,396 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:37:45,398 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:37:45,399 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:37:45,400 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:37:45,453 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:37:45,454 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:37:46,384 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:37:46,385 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:37:46,386 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:37:46,431 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:37:46,438 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:37:46,439 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:37:46,696 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:37:46,977 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:37:46,978 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:37:46,979 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:37:46,986 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:37:46,987 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:37:46,988 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:37:47,000 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:37:47,068 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:37:47,225 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:37:47,391 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:37:47,392 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:37:47,444 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:37:47,498 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:37:47,499 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:37:47,556 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:37:47,612 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:37:47,668 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:37:47,668 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:37:47,676 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:37:47,768 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:37:47,881 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:37:47,937 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:37:48,020 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:37:48,059 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:37:48,061 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:37:48,172 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:37:48,279 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:37:48,391 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:37:48,393 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:37:48,394 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:37:48,498 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:37:48,499 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:37:48,508 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:37:48,684 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:37:48,693 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:37:48,694 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:37:48,734 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:37:48,887 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:37:49,021 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:37:49,026 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:37:49,032 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:37:49,037 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:37:49,042 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:37:49,048 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:37:49,055 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:37:49,086 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:37:49,087 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:37:49,095 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:37:49,097 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:37:49,112 - INFO - Para 'availability_365':
2025-05-17 00:37:49,113 - INFO -   - Número de valores < 0: 431
2025-05-17 00:37:49,114 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:37:49,114 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:37:49,115 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:37:49,122 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:37:49,126 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:37:49,127 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:37:49,135 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:37:49,136 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:37:49,139 - INFO - Para 'minimum_nights':
2025-05-17 00:37:49,139 - INFO -   - Número de valores < 1: 13
2025-05-17 00:37:49,140 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:37:49,140 - INFO -   - Número de valores > 365: 35
2025-05-17 00:37:49,140 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:37:49,148 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:37:49,151 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:37:49,153 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:37:49,221 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:37:49,223 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:37:49,244 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:37:49,245 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:37:49,267 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:37:49,276 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 00:37:49,288 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 00:37:49,317 - INFO - La moda para 'country' es: 'United States'
2025-05-17 00:37:49,349 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 00:37:49,369 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 00:37:49,399 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 00:37:49,434 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 00:37:49,476 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 00:37:49,493 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 00:37:49,526 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:37:49,554 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:37:49,564 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:38:35,315 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:38:35,316 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:38:35,323 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:38:35,324 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:38:35,327 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:38:35,327 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:38:35,407 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:38:35,408 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:38:36,401 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:38:36,401 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:38:36,402 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:38:36,444 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:38:36,451 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:38:36,453 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:38:36,714 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:38:36,981 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:38:36,982 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:38:36,982 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:38:36,989 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:38:36,990 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:38:36,991 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:38:37,012 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:38:37,069 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:38:37,216 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:38:37,372 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:38:37,373 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:38:37,436 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:38:37,495 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:38:37,495 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:38:37,554 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:38:37,614 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:38:37,660 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:38:37,661 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:38:37,667 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:38:37,753 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:38:37,853 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:38:37,902 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:38:37,974 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:38:38,007 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:38:38,009 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:38:38,103 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:38:38,199 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:38:38,293 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:38:38,296 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:38:38,297 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:38:38,388 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:38:38,389 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:38:38,398 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:38:38,577 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:38:38,587 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:38:38,589 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:38:38,628 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:38:38,769 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:38:38,875 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:38:38,881 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:38:38,886 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:38:38,893 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:38:38,901 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:38:38,907 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:38:38,915 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:38:38,948 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:38:38,949 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:38:38,958 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:38:38,961 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:38:38,976 - INFO - Para 'availability_365':
2025-05-17 00:38:38,977 - INFO -   - Número de valores < 0: 431
2025-05-17 00:38:38,978 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:38:38,979 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:38:38,979 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:38:38,985 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:38:38,989 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:38:38,990 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:38:38,998 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:38:38,999 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:38:39,002 - INFO - Para 'minimum_nights':
2025-05-17 00:38:39,003 - INFO -   - Número de valores < 1: 13
2025-05-17 00:38:39,003 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:38:39,004 - INFO -   - Número de valores > 365: 35
2025-05-17 00:38:39,004 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:38:39,011 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:38:39,014 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:38:39,015 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:38:39,083 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:38:39,085 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:38:39,106 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:38:39,107 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:38:39,127 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:38:39,137 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 00:38:39,147 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 00:38:39,171 - INFO - La moda para 'country' es: 'United States'
2025-05-17 00:38:39,198 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 00:38:39,216 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 00:38:39,244 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 00:38:39,267 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 00:38:39,295 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 00:38:39,309 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 00:38:39,337 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 00:38:39,348 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 00:38:39,360 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 00:38:39,361 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 00:38:39,368 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:38:39,386 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:38:39,393 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:39:24,266 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:39:24,267 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:39:24,279 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:39:24,281 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:39:24,283 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:39:24,284 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:39:24,377 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:39:24,378 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:39:25,359 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:39:25,360 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:39:25,361 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:39:25,396 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:39:25,403 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:39:25,405 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:39:25,644 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:39:25,912 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:39:25,912 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:39:25,913 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:39:25,918 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:39:25,919 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:39:25,920 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:39:25,949 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:39:26,005 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:39:26,145 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:39:26,301 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:39:26,301 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:39:26,341 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:39:26,378 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:39:26,379 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:39:26,419 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:39:26,463 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:39:26,509 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:39:26,509 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:39:26,515 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:39:26,592 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:39:26,682 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:39:26,729 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:39:26,796 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:39:26,833 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:39:26,834 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:39:26,924 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:39:27,017 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:39:27,113 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:39:27,116 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:39:27,117 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:39:27,217 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:39:27,218 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:39:27,227 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:39:27,394 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:39:27,404 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:39:27,405 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:39:27,441 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:39:27,543 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:39:27,643 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:39:27,648 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:39:27,653 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:39:27,659 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:39:27,664 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:39:27,669 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:39:27,676 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:39:27,703 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:39:27,704 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:39:27,713 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:39:27,714 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:39:27,727 - INFO - Para 'availability_365':
2025-05-17 00:39:27,727 - INFO -   - Número de valores < 0: 431
2025-05-17 00:39:27,728 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:39:27,728 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:39:27,729 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:39:27,734 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:39:27,738 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:39:27,740 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:39:27,748 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:39:27,750 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:39:27,752 - INFO - Para 'minimum_nights':
2025-05-17 00:39:27,753 - INFO -   - Número de valores < 1: 13
2025-05-17 00:39:27,753 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:39:27,754 - INFO -   - Número de valores > 365: 35
2025-05-17 00:39:27,754 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:39:27,761 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:39:27,764 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:39:27,765 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:39:27,833 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:39:27,835 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:39:27,855 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:39:27,856 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:39:27,875 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:39:27,884 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 00:39:27,894 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 00:39:27,916 - INFO - La moda para 'country' es: 'United States'
2025-05-17 00:39:27,943 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 00:39:27,960 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 00:39:27,987 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 00:39:28,009 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 00:39:28,034 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 00:39:28,048 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 00:39:28,074 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 00:39:28,083 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 00:39:28,095 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 00:39:28,096 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 00:39:28,102 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:39:28,118 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:39:28,132 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:54:01,239 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:54:01,240 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:54:01,249 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:54:01,251 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:54:01,253 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:54:01,254 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:54:01,263 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:54:01,280 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:54:02,212 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:54:02,213 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:54:02,214 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:54:02,243 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:54:02,251 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:54:02,252 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:54:02,436 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:54:02,636 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:54:02,637 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:54:02,638 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:54:02,644 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:54:02,645 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:54:02,646 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:54:02,658 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:54:02,703 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:54:02,792 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:54:02,893 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:54:02,894 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:54:02,923 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:54:02,949 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:54:02,950 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:54:02,978 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:54:03,008 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:54:03,050 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:54:03,051 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:54:03,057 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:54:03,117 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:54:03,182 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:54:03,227 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:54:03,278 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:54:03,315 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:54:03,319 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:54:03,425 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:54:03,499 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:54:03,575 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:54:03,577 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:54:03,578 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:54:03,660 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:54:03,662 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:54:03,672 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:54:03,825 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:54:03,835 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:54:03,837 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:54:03,867 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:54:03,957 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:54:04,044 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:54:04,049 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:54:04,055 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:54:04,060 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:54:04,066 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:54:04,072 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:54:04,078 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:54:04,109 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:54:04,110 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:54:04,119 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:54:04,120 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:54:04,132 - INFO - Para 'availability_365':
2025-05-17 00:54:04,133 - INFO -   - Número de valores < 0: 431
2025-05-17 00:54:04,133 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:54:04,134 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:54:04,135 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:54:04,142 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:54:04,147 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:54:04,149 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:54:04,159 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:54:04,161 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:54:04,164 - INFO - Para 'minimum_nights':
2025-05-17 00:54:04,165 - INFO -   - Número de valores < 1: 13
2025-05-17 00:54:04,166 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:54:04,167 - INFO -   - Número de valores > 365: 35
2025-05-17 00:54:04,167 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:54:04,176 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:54:04,181 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:54:04,183 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:54:04,271 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:54:04,273 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:54:04,312 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:54:04,313 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:54:04,345 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:54:04,360 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 00:54:04,370 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 00:54:04,391 - INFO - La moda para 'country' es: 'United States'
2025-05-17 00:54:04,419 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 00:54:04,435 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 00:54:04,472 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 00:54:04,498 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 00:54:04,532 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 00:54:04,551 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 00:54:04,612 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 00:54:04,626 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 00:54:04,642 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 00:54:04,644 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 00:54:04,683 - INFO - Celda 12.6: Eliminando la columna 'house_rules'.
2025-05-17 00:54:04,705 - INFO - Columna 'house_rules' encontrada.
2025-05-17 00:54:04,708 - INFO -   Nulos antes de eliminar: 51842 (50.80%)
2025-05-17 00:54:04,728 - INFO - Columna 'house_rules' eliminada exitosamente.
2025-05-17 00:54:04,735 - INFO - Dimensiones de df_cleaning después de eliminar 'house_rules': (102058, 25)
2025-05-17 00:54:04,771 - INFO - Celda 12.7: Iniciando imputación de nulos para 'last_review' con la media.
2025-05-17 00:54:04,774 - INFO - Nulos en 'last_review' ANTES de la imputación: 15832
2025-05-17 00:54:04,778 - INFO - La fecha media calculada para 'last_review' es: 2019-06-11 02:12:22.996312064
2025-05-17 00:54:04,785 - INFO - Nulos en 'last_review' DESPUÉS de la imputación: 0
2025-05-17 00:54:04,803 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 00:54:04,826 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 00:54:04,849 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:57:34,198 - INFO - Celda 12.7.1: Identificando y manejando fechas futuras erróneas en 'last_review'.
2025-05-17 00:57:34,200 - INFO - Umbral para considerar fecha futura en 'last_review': > 2023-12-31
2025-05-17 00:57:34,204 - INFO - Número de fechas en 'last_review' consideradas futuras (posteriores a 2023-12-31): 5
2025-05-17 00:57:34,205 - INFO -   Valores únicos de fechas futuras encontradas (primeros 10): ['2024-08-15', '2025-06-26', '2058-06-16', '2026-03-28', '2040-06-16']
2025-05-17 00:57:34,207 - INFO - 5 fechas futuras en 'last_review' han sido convertidas a NaT.
2025-05-17 00:57:34,209 - INFO - Total de nulos (NaT) en 'last_review' antes de la imputación por media: 5
2025-05-17 00:58:52,298 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:58:52,300 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:58:52,309 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:58:52,311 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:58:52,313 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:58:52,315 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:58:52,410 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:58:52,411 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:58:53,683 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:58:53,684 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:58:53,686 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:58:53,725 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:58:53,737 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:58:53,739 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:58:54,090 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:58:54,400 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:58:54,401 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:58:54,401 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:58:54,411 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:58:54,412 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:58:54,413 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:58:54,426 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:58:54,499 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:58:54,650 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:58:54,814 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:58:54,816 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:58:54,860 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:58:54,902 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:58:54,903 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:58:54,951 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:58:54,996 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:58:55,045 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:58:55,046 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:58:55,055 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:58:55,147 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:58:55,247 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:58:55,299 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:58:55,375 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:58:55,420 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:58:55,422 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:58:55,521 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:58:55,616 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:58:55,727 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:58:55,731 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:58:55,731 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:58:55,839 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:58:55,840 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:58:55,850 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:58:56,035 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:58:56,048 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:58:56,050 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:58:56,090 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:58:56,224 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:58:56,356 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:58:56,364 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:58:56,373 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:58:56,381 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:58:56,389 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:58:56,397 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:58:56,407 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:58:56,446 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:58:56,447 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:58:56,460 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:58:56,462 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:58:56,495 - INFO - Para 'availability_365':
2025-05-17 00:58:56,496 - INFO -   - Número de valores < 0: 431
2025-05-17 00:58:56,498 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:58:56,499 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:58:56,502 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:58:56,533 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:58:56,543 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:58:56,545 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:58:56,564 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:58:56,569 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:58:56,575 - INFO - Para 'minimum_nights':
2025-05-17 00:58:56,576 - INFO -   - Número de valores < 1: 13
2025-05-17 00:58:56,578 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:58:56,579 - INFO -   - Número de valores > 365: 35
2025-05-17 00:58:56,580 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:58:56,591 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:58:56,597 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:58:56,599 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:58:56,710 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:58:56,713 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:58:56,747 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:58:56,749 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:58:56,788 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:58:56,810 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 00:58:56,824 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 00:58:56,852 - INFO - La moda para 'country' es: 'United States'
2025-05-17 00:58:56,882 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 00:58:56,900 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 00:58:56,929 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 00:58:56,954 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 00:58:56,985 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 00:58:57,001 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 00:58:57,034 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 00:58:57,049 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 00:58:57,064 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 00:58:57,065 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 00:58:57,078 - INFO - Celda 12.6: Eliminando la columna 'house_rules'.
2025-05-17 00:58:57,087 - INFO - Columna 'house_rules' encontrada.
2025-05-17 00:58:57,088 - INFO -   Nulos antes de eliminar: 51842 (50.80%)
2025-05-17 00:58:57,100 - INFO - Columna 'house_rules' eliminada exitosamente.
2025-05-17 00:58:57,100 - INFO - Dimensiones de df_cleaning después de eliminar 'house_rules': (102058, 25)
2025-05-17 00:58:57,116 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 00:58:57,118 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 00:58:57,121 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 00:58:57,122 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 00:59:53,383 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 00:59:53,385 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 00:59:53,392 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:59:53,393 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 00:59:53,396 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 00:59:53,397 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 00:59:53,455 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 00:59:53,456 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 00:59:54,405 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 00:59:54,406 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 00:59:54,407 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 00:59:54,438 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 00:59:54,448 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 00:59:54,449 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 00:59:54,704 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 00:59:54,957 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 00:59:54,957 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 00:59:54,958 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 00:59:54,965 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 00:59:54,966 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 00:59:54,966 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 00:59:54,978 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:59:55,033 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 00:59:55,165 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 00:59:55,304 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 00:59:55,305 - INFO - Procesando 'host_identity_verified'.
2025-05-17 00:59:55,342 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 00:59:55,378 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 00:59:55,379 - INFO - Procesando 'instant_bookable'.
2025-05-17 00:59:55,421 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 00:59:55,465 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 00:59:55,518 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 00:59:55,519 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 00:59:55,525 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 00:59:55,611 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 00:59:55,704 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 00:59:55,753 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 00:59:55,817 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 00:59:55,854 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 00:59:55,855 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 00:59:55,940 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 00:59:56,022 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 00:59:56,107 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 00:59:56,110 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 00:59:56,110 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 00:59:56,202 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 00:59:56,203 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 00:59:56,211 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 00:59:56,380 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 00:59:56,389 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 00:59:56,391 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 00:59:56,425 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 00:59:56,523 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 00:59:56,619 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 00:59:56,625 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 00:59:56,630 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 00:59:56,635 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 00:59:56,640 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 00:59:56,646 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 00:59:56,653 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 00:59:56,684 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 00:59:56,684 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 00:59:56,692 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 00:59:56,694 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 00:59:56,706 - INFO - Para 'availability_365':
2025-05-17 00:59:56,706 - INFO -   - Número de valores < 0: 431
2025-05-17 00:59:56,707 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 00:59:56,707 - INFO -   - Número de valores > 365: 2754
2025-05-17 00:59:56,707 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 00:59:56,715 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 00:59:56,719 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 00:59:56,721 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 00:59:56,730 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 00:59:56,731 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 00:59:56,735 - INFO - Para 'minimum_nights':
2025-05-17 00:59:56,735 - INFO -   - Número de valores < 1: 13
2025-05-17 00:59:56,736 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 00:59:56,736 - INFO -   - Número de valores > 365: 35
2025-05-17 00:59:56,737 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 00:59:56,743 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 00:59:56,748 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 00:59:56,750 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 00:59:56,844 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 00:59:56,846 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 00:59:56,866 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 00:59:56,867 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 00:59:56,887 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 00:59:56,898 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 00:59:56,908 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 00:59:56,930 - INFO - La moda para 'country' es: 'United States'
2025-05-17 00:59:56,956 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 00:59:56,972 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 00:59:56,997 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 00:59:57,019 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 00:59:57,045 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 00:59:57,058 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 00:59:57,084 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 00:59:57,093 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 00:59:57,103 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 00:59:57,104 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 00:59:57,113 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 00:59:57,114 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 00:59:57,116 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 00:59:57,117 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:01:51,166 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:01:51,167 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:01:51,174 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:01:51,175 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:01:51,176 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:01:51,177 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:01:51,279 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:01:51,280 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:01:52,150 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:01:52,151 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:01:52,152 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:01:52,185 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:01:52,191 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:01:52,192 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:01:52,428 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:01:52,687 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:01:52,688 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:01:52,688 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:01:52,694 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:01:52,695 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:01:52,696 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:01:52,707 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:01:52,763 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:01:52,905 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:01:53,051 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:01:53,053 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:01:53,092 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:01:53,130 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:01:53,131 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:01:53,172 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:01:53,211 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:01:53,260 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:01:53,260 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:01:53,267 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:01:53,350 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:01:53,447 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:01:53,495 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:01:53,565 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:01:53,601 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:01:53,602 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:01:53,689 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:01:53,779 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:01:53,868 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:01:53,870 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:01:53,871 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:01:53,964 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:01:53,965 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:01:53,972 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:01:54,140 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:01:54,151 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:01:54,152 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:01:54,188 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:01:54,290 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:01:54,386 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:01:54,391 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:01:54,396 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:01:54,402 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:01:54,407 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:01:54,412 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:01:54,418 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:01:54,449 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:01:54,450 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:01:54,457 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:01:54,458 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:01:54,471 - INFO - Para 'availability_365':
2025-05-17 01:01:54,472 - INFO -   - Número de valores < 0: 431
2025-05-17 01:01:54,472 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:01:54,473 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:01:54,473 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:01:54,479 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:01:54,484 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:01:54,485 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:01:54,494 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:01:54,495 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:01:54,499 - INFO - Para 'minimum_nights':
2025-05-17 01:01:54,500 - INFO -   - Número de valores < 1: 13
2025-05-17 01:01:54,500 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:01:54,501 - INFO -   - Número de valores > 365: 35
2025-05-17 01:01:54,501 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:01:54,522 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:01:54,526 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:01:54,528 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:01:54,614 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:01:54,616 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:01:54,638 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:01:54,639 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:01:54,659 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:01:54,669 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:01:54,679 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:01:54,703 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:01:54,730 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:01:54,745 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:01:54,771 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:01:54,793 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:01:54,821 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:01:54,835 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:01:54,861 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:01:54,871 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:01:54,883 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:01:54,883 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:01:54,891 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:01:54,893 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:01:54,895 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:01:54,896 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:01:54,910 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:01:54,914 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:01:54,917 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:01:54,932 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:01:54,934 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:01:54,936 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:01:54,938 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:01:54,950 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:01:54,970 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:01:54,976 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:02:28,115 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:02:28,121 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:02:28,146 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:02:28,149 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:02:28,152 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:02:28,153 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:02:28,230 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:02:28,231 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:02:29,163 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:02:29,164 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:02:29,164 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:02:29,198 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:02:29,205 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:02:29,206 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:02:29,446 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:02:29,719 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:02:29,719 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:02:29,720 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:02:29,726 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:02:29,727 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:02:29,728 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:02:29,765 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:02:29,826 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:02:29,964 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:02:30,127 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:02:30,130 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:02:30,175 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:02:30,227 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:02:30,229 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:02:30,293 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:02:30,337 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:02:30,388 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:02:30,388 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:02:30,396 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:02:30,484 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:02:30,583 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:02:30,630 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:02:30,697 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:02:30,731 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:02:30,732 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:02:30,822 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:02:30,907 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:02:30,993 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:02:30,996 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:02:30,997 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:02:31,098 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:02:31,099 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:02:31,107 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:02:31,280 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:02:31,289 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:02:31,291 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:02:31,326 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:02:31,428 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:02:31,521 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:02:31,526 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:02:31,532 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:02:31,538 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:02:31,543 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:02:31,549 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:02:31,557 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:02:31,593 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:02:31,594 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:02:31,605 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:02:31,607 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:02:31,623 - INFO - Para 'availability_365':
2025-05-17 01:02:31,623 - INFO -   - Número de valores < 0: 431
2025-05-17 01:02:31,624 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:02:31,625 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:02:31,625 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:02:31,632 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:02:31,636 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:02:31,638 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:02:31,646 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:02:31,649 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:02:31,652 - INFO - Para 'minimum_nights':
2025-05-17 01:02:31,653 - INFO -   - Número de valores < 1: 13
2025-05-17 01:02:31,653 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:02:31,654 - INFO -   - Número de valores > 365: 35
2025-05-17 01:02:31,654 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:02:31,662 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:02:31,666 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:02:31,668 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:02:31,741 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:02:31,742 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:02:31,767 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:02:31,768 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:02:31,790 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:02:31,801 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:02:31,809 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:02:31,831 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:02:31,858 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:02:31,873 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:02:31,898 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:02:31,921 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:02:31,946 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:02:31,960 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:02:31,988 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:02:31,996 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:02:32,007 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:02:32,008 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:02:32,016 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:02:32,018 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:02:32,020 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:02:32,021 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:02:32,034 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:02:32,038 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:02:32,040 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:02:32,054 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:02:32,056 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:02:32,058 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:02:32,060 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:02:32,072 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:02:32,089 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:02:32,094 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:03:20,392 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:03:20,393 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:03:20,402 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:03:20,403 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:03:20,405 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:03:20,405 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:03:20,483 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:03:20,484 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:03:21,356 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:03:21,357 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:03:21,357 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:03:21,391 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:03:21,398 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:03:21,400 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:03:21,649 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:03:21,922 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:03:21,923 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:03:21,923 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:03:21,929 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:03:21,930 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:03:21,931 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:03:21,954 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:03:22,006 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:03:22,143 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:03:22,303 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:03:22,304 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:03:22,346 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:03:22,388 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:03:22,389 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:03:22,428 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:03:22,469 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:03:22,513 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:03:22,513 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:03:22,521 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:03:22,599 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:03:22,695 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:03:22,748 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:03:22,827 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:03:22,867 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:03:22,868 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:03:22,960 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:03:23,044 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:03:23,130 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:03:23,134 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:03:23,135 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:03:23,229 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:03:23,231 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:03:23,239 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:03:23,406 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:03:23,417 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:03:23,418 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:03:23,455 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:03:23,557 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:03:23,655 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:03:23,660 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:03:23,665 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:03:23,671 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:03:23,676 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:03:23,681 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:03:23,688 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:03:23,718 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:03:23,719 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:03:23,728 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:03:23,734 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:03:23,753 - INFO - Para 'availability_365':
2025-05-17 01:03:23,754 - INFO -   - Número de valores < 0: 431
2025-05-17 01:03:23,755 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:03:23,756 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:03:23,756 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:03:23,776 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:03:23,780 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:03:23,782 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:03:23,797 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:03:23,799 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:03:23,804 - INFO - Para 'minimum_nights':
2025-05-17 01:03:23,805 - INFO -   - Número de valores < 1: 13
2025-05-17 01:03:23,805 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:03:23,806 - INFO -   - Número de valores > 365: 35
2025-05-17 01:03:23,806 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:03:23,812 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:03:23,817 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:03:23,818 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:03:23,885 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:03:23,887 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:03:23,909 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:03:23,910 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:03:23,931 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:03:23,942 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:03:23,952 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:03:23,975 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:03:24,002 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:03:24,019 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:03:24,046 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:03:24,072 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:03:24,100 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:03:24,115 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:03:24,143 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:03:24,152 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:03:24,163 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:03:24,164 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:03:24,173 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:03:24,174 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:03:24,176 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:03:24,177 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:03:24,192 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:03:24,196 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:03:24,198 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:03:24,213 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:03:24,216 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:03:24,218 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:03:24,220 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:03:24,230 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:03:24,247 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:03:24,254 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:03:31,152 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:03:31,153 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:03:31,160 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:03:31,162 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:03:31,163 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:03:31,164 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:03:31,224 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:03:31,225 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:03:32,157 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:03:32,158 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:03:32,159 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:03:32,192 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:03:32,199 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:03:32,201 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:03:32,442 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:03:32,706 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:03:32,707 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:03:32,707 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:03:32,713 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:03:32,714 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:03:32,715 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:03:32,737 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:03:32,792 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:03:32,932 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:03:33,079 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:03:33,080 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:03:33,120 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:03:33,158 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:03:33,159 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:03:33,199 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:03:33,240 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:03:33,288 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:03:33,288 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:03:33,295 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:03:33,377 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:03:33,472 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:03:33,520 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:03:33,591 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:03:33,629 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:03:33,630 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:03:33,719 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:03:33,806 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:03:33,895 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:03:33,898 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:03:33,899 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:03:33,990 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:03:33,991 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:03:33,998 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:03:34,168 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:03:34,177 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:03:34,178 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:03:34,216 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:03:34,316 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:03:34,411 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:03:34,417 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:03:34,422 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:03:34,427 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:03:34,432 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:03:34,438 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:03:34,444 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:03:34,476 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:03:34,477 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:03:34,491 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:03:34,495 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:03:34,515 - INFO - Para 'availability_365':
2025-05-17 01:03:34,517 - INFO -   - Número de valores < 0: 431
2025-05-17 01:03:34,517 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:03:34,518 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:03:34,519 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:03:34,533 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:03:34,539 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:03:34,540 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:03:34,552 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:03:34,554 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:03:34,558 - INFO - Para 'minimum_nights':
2025-05-17 01:03:34,558 - INFO -   - Número de valores < 1: 13
2025-05-17 01:03:34,559 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:03:34,560 - INFO -   - Número de valores > 365: 35
2025-05-17 01:03:34,561 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:03:34,569 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:03:34,573 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:03:34,574 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:03:34,637 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:03:34,639 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:03:34,658 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:03:34,659 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:03:34,679 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:03:34,690 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:03:34,700 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:03:34,724 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:03:34,751 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:03:34,767 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:03:34,794 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:03:34,817 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:03:34,843 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:03:34,857 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:03:34,884 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:03:34,892 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:03:34,904 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:03:34,905 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:03:34,915 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:03:34,917 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:03:34,919 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:03:34,920 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:03:34,932 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:03:34,936 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:03:34,938 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:03:34,952 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:03:34,954 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:03:34,956 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:03:34,957 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:03:34,968 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:03:34,985 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:03:34,992 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:04:04,988 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:04:04,989 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:04:04,995 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:04:04,996 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:04:04,999 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:04:05,000 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:04:05,086 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:04:05,088 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:04:05,976 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:04:05,977 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:04:05,978 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:04:06,013 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:04:06,020 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:04:06,022 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:04:06,277 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:04:06,545 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:04:06,546 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:04:06,546 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:04:06,553 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:04:06,554 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:04:06,555 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:04:06,578 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:04:06,635 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:04:06,775 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:04:06,922 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:04:06,923 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:04:06,965 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:04:07,006 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:04:07,006 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:04:07,047 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:04:07,088 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:04:07,134 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:04:07,135 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:04:07,141 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:04:07,223 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:04:07,317 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:04:07,364 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:04:07,434 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:04:07,468 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:04:07,470 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:04:07,570 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:04:07,664 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:04:07,753 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:04:07,756 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:04:07,757 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:04:07,848 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:04:07,849 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:04:07,858 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:04:08,031 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:04:08,042 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:04:08,043 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:04:08,081 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:04:08,185 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:04:08,285 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:04:08,291 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:04:08,296 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:04:08,302 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:04:08,307 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:04:08,313 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:04:08,320 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:04:08,357 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:04:08,358 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:04:08,367 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:04:08,369 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:04:08,381 - INFO - Para 'availability_365':
2025-05-17 01:04:08,381 - INFO -   - Número de valores < 0: 431
2025-05-17 01:04:08,382 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:04:08,383 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:04:08,384 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:04:08,391 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:04:08,396 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:04:08,397 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:04:08,407 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:04:08,409 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:04:08,421 - INFO - Para 'minimum_nights':
2025-05-17 01:04:08,425 - INFO -   - Número de valores < 1: 13
2025-05-17 01:04:08,426 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:04:08,429 - INFO -   - Número de valores > 365: 35
2025-05-17 01:04:08,430 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:04:08,447 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:04:08,455 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:04:08,457 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:04:08,546 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:04:08,550 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:04:08,572 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:04:08,573 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:04:08,599 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:04:08,611 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:04:08,621 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:04:08,645 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:04:08,674 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:04:08,692 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:04:08,724 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:04:08,750 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:04:08,779 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:04:08,795 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:04:08,828 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:04:08,839 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:04:08,852 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:04:08,853 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:04:08,864 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:04:08,866 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:04:08,869 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:04:08,870 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:04:08,882 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:04:08,887 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:04:08,889 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:04:08,904 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:04:08,906 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:04:08,909 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:04:08,911 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:04:08,923 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:04:08,941 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:04:08,946 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:06:24,093 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:06:24,094 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:06:24,103 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:06:24,104 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:06:24,105 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:06:24,106 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:06:24,171 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:06:24,173 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:06:25,220 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:06:25,221 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:06:25,222 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:06:25,253 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:06:25,259 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:06:25,260 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:06:25,491 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:06:25,759 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:06:25,760 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:06:25,760 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:06:25,767 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:06:25,769 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:06:25,770 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:06:25,786 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:06:25,845 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:06:25,991 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:06:26,150 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:06:26,152 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:06:26,189 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:06:26,226 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:06:26,226 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:06:26,265 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:06:26,304 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:06:26,351 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:06:26,352 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:06:26,359 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:06:26,486 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:06:26,578 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:06:26,625 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:06:26,694 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:06:26,730 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:06:26,731 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:06:26,820 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:06:26,906 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:06:26,994 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:06:26,996 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:06:26,997 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:06:27,088 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:06:27,089 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:06:27,096 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:06:27,265 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:06:27,281 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:06:27,282 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:06:27,317 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:06:27,413 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:06:27,508 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:06:27,514 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:06:27,519 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:06:27,526 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:06:27,534 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:06:27,540 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:06:27,549 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:06:27,581 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:06:27,582 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:06:27,591 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:06:27,593 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:06:27,606 - INFO - Para 'availability_365':
2025-05-17 01:06:27,607 - INFO -   - Número de valores < 0: 431
2025-05-17 01:06:27,607 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:06:27,608 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:06:27,608 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:06:27,615 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:06:27,620 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:06:27,621 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:06:27,630 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:06:27,631 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:06:27,635 - INFO - Para 'minimum_nights':
2025-05-17 01:06:27,636 - INFO -   - Número de valores < 1: 13
2025-05-17 01:06:27,637 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:06:27,637 - INFO -   - Número de valores > 365: 35
2025-05-17 01:06:27,638 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:06:27,645 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:06:27,649 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:06:27,651 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:06:27,718 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:06:27,720 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:06:27,744 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:06:27,745 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:06:27,763 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:06:27,775 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:06:27,784 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:06:27,808 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:06:27,833 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:06:27,850 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:06:27,876 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:06:27,897 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:06:27,924 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:06:27,938 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:06:27,965 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:06:27,976 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:06:27,987 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:06:27,988 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:06:27,998 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:06:28,000 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:06:28,002 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:06:28,005 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:06:28,028 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:06:28,036 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:06:28,040 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:06:28,064 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:06:28,066 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:06:28,068 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:06:28,070 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:06:28,103 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:06:28,116 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:06:28,124 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:09:16,475 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:09:16,476 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:09:16,485 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:09:16,486 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:09:16,488 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:09:16,489 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:09:16,579 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:09:16,581 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:09:17,525 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:09:17,527 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:09:17,527 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:09:17,562 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:09:17,571 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:09:17,572 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:09:17,829 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:09:18,099 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:09:18,100 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:09:18,100 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:09:18,108 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:09:18,109 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:09:18,110 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:09:18,135 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:09:18,190 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:09:18,326 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:09:18,475 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:09:18,476 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:09:18,514 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:09:18,551 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:09:18,552 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:09:18,592 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:09:18,633 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:09:18,678 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:09:18,679 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:09:18,687 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:09:18,770 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:09:18,862 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:09:18,908 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:09:18,975 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:09:19,010 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:09:19,011 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:09:19,099 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:09:19,188 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:09:19,279 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:09:19,282 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:09:19,283 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:09:19,375 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:09:19,376 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:09:19,385 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:09:19,556 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:09:19,566 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:09:19,567 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:09:19,602 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:09:19,700 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:09:19,794 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:09:19,799 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:09:19,805 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:09:19,810 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:09:19,815 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:09:19,821 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:09:19,827 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:09:19,861 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:09:19,861 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:09:19,870 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:09:19,871 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:09:19,884 - INFO - Para 'availability_365':
2025-05-17 01:09:19,884 - INFO -   - Número de valores < 0: 431
2025-05-17 01:09:19,885 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:09:19,885 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:09:19,886 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:09:19,892 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:09:19,897 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:09:19,899 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:09:19,908 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:09:19,909 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:09:19,913 - INFO - Para 'minimum_nights':
2025-05-17 01:09:19,914 - INFO -   - Número de valores < 1: 13
2025-05-17 01:09:19,914 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:09:19,915 - INFO -   - Número de valores > 365: 35
2025-05-17 01:09:19,915 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:09:19,922 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:09:19,926 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:09:19,928 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:09:19,991 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:09:19,993 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:09:20,015 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:09:20,016 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:09:20,038 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:09:20,049 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:09:20,058 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:09:20,082 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:09:20,108 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:09:20,124 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:09:20,151 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:09:20,173 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:09:20,201 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:09:20,213 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:09:20,240 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:09:20,250 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:09:20,261 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:09:20,262 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:09:20,270 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:09:20,272 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:09:20,275 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:09:20,276 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:09:20,293 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:09:20,296 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:09:20,298 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:09:20,312 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:09:20,315 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:09:20,317 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:09:20,319 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:09:20,332 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:09:20,349 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:09:20,356 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:09:24,306 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:09:24,307 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:09:24,316 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:09:24,317 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:09:24,318 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:09:24,319 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:09:24,380 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:09:24,381 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:09:25,220 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:09:25,221 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:09:25,222 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:09:25,255 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:09:25,262 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:09:25,264 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:09:25,505 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:09:25,788 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:09:25,788 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:09:25,789 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:09:25,795 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:09:25,797 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:09:25,798 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:09:25,826 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:09:25,883 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:09:26,024 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:09:26,171 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:09:26,172 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:09:26,212 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:09:26,251 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:09:26,251 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:09:26,293 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:09:26,334 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:09:26,379 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:09:26,379 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:09:26,387 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:09:26,471 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:09:26,566 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:09:26,612 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:09:26,683 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:09:26,717 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:09:26,718 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:09:26,809 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:09:26,895 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:09:26,985 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:09:26,987 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:09:26,988 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:09:27,081 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:09:27,082 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:09:27,089 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:09:27,261 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:09:27,271 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:09:27,272 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:09:27,309 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:09:27,408 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:09:27,504 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:09:27,510 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:09:27,515 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:09:27,520 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:09:27,526 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:09:27,531 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:09:27,538 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:09:27,571 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:09:27,572 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:09:27,580 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:09:27,582 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:09:27,593 - INFO - Para 'availability_365':
2025-05-17 01:09:27,593 - INFO -   - Número de valores < 0: 431
2025-05-17 01:09:27,594 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:09:27,594 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:09:27,595 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:09:27,601 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:09:27,606 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:09:27,607 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:09:27,616 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:09:27,617 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:09:27,620 - INFO - Para 'minimum_nights':
2025-05-17 01:09:27,621 - INFO -   - Número de valores < 1: 13
2025-05-17 01:09:27,621 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:09:27,622 - INFO -   - Número de valores > 365: 35
2025-05-17 01:09:27,622 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:09:27,629 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:09:27,634 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:09:27,635 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:09:27,729 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:09:27,731 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:09:27,753 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:09:27,753 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:09:27,772 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:09:27,783 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:09:27,791 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:09:27,815 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:09:27,841 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:09:27,857 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:09:27,884 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:09:27,906 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:09:27,933 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:09:27,946 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:09:27,981 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:09:27,991 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:09:28,002 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:09:28,003 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:09:28,011 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:09:28,012 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:09:28,015 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:09:28,016 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:09:28,030 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:09:28,035 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:09:28,037 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:09:28,051 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:09:28,053 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:09:28,055 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:09:28,056 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:09:28,069 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:09:28,088 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:09:28,093 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:12:17,114 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:12:17,116 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:12:17,134 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:12:17,136 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:12:17,138 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:12:17,140 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:12:17,223 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:12:17,224 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:12:18,243 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:12:18,244 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:12:18,245 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:12:18,287 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:12:18,295 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:12:18,297 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:12:18,556 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:12:18,853 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:12:18,853 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:12:18,854 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:12:18,862 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:12:18,863 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:12:18,864 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:12:18,880 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:12:18,940 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:12:19,087 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:12:19,249 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:12:19,250 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:12:19,291 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:12:19,333 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:12:19,334 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:12:19,380 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:12:19,429 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:12:19,487 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:12:19,488 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:12:19,496 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:12:19,583 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:12:19,681 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:12:19,733 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:12:19,807 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:12:19,844 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:12:19,846 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:12:19,934 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:12:20,026 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:12:20,121 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:12:20,124 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:12:20,125 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:12:20,231 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:12:20,232 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:12:20,239 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:12:20,417 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:12:20,428 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:12:20,429 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:12:20,467 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:12:20,568 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:12:20,668 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:12:20,673 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:12:20,678 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:12:20,684 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:12:20,689 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:12:20,694 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:12:20,701 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:12:20,733 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:12:20,734 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:12:20,742 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:12:20,743 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:12:20,755 - INFO - Para 'availability_365':
2025-05-17 01:12:20,756 - INFO -   - Número de valores < 0: 431
2025-05-17 01:12:20,756 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:12:20,757 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:12:20,757 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:12:20,765 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:12:20,770 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:12:20,771 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:12:20,780 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:12:20,782 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:12:20,785 - INFO - Para 'minimum_nights':
2025-05-17 01:12:20,786 - INFO -   - Número de valores < 1: 13
2025-05-17 01:12:20,786 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:12:20,786 - INFO -   - Número de valores > 365: 35
2025-05-17 01:12:20,787 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:12:20,795 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:12:20,799 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:12:20,800 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:12:20,866 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:12:20,867 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:12:20,891 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:12:20,891 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:12:20,912 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:12:20,922 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:12:20,933 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:12:20,956 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:12:20,983 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:12:21,000 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:12:21,027 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:12:21,050 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:12:21,078 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:12:21,091 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:12:21,119 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:12:21,129 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:12:21,140 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:12:21,140 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:12:21,160 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:12:21,161 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:12:21,163 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:12:21,164 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:12:21,176 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:12:21,181 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:12:21,183 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:12:21,196 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:12:21,198 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:12:21,200 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:12:21,202 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:12:21,230 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:12:21,246 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:12:21,264 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:15:02,661 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:15:02,664 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:15:02,667 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:15:02,667 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:15:02,674 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:15:40,393 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:15:40,395 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:15:40,405 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:15:40,407 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:15:40,408 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:15:40,413 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:15:40,507 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:15:40,509 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:15:41,483 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:15:41,484 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:15:41,484 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:15:41,516 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:15:41,524 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:15:41,525 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:15:41,763 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:15:42,024 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:15:42,025 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:15:42,025 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:15:42,032 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:15:42,033 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:15:42,034 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:15:42,058 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:15:42,118 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:15:42,259 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:15:42,409 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:15:42,410 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:15:42,447 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:15:42,483 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:15:42,484 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:15:42,524 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:15:42,563 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:15:42,610 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:15:42,611 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:15:42,617 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:15:42,705 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:15:42,807 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:15:42,857 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:15:42,926 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:15:42,963 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:15:42,964 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:15:43,053 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:15:43,143 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:15:43,235 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:15:43,238 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:15:43,239 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:15:43,331 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:15:43,332 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:15:43,340 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:15:43,514 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:15:43,525 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:15:43,526 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:15:43,562 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:15:43,666 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:15:43,773 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:15:43,778 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:15:43,784 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:15:43,789 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:15:43,795 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:15:43,803 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:15:43,811 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:15:43,842 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:15:43,843 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:15:43,851 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:15:43,852 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:15:43,865 - INFO - Para 'availability_365':
2025-05-17 01:15:43,865 - INFO -   - Número de valores < 0: 431
2025-05-17 01:15:43,866 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:15:43,866 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:15:43,867 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:15:43,873 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:15:43,879 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:15:43,880 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:15:43,888 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:15:43,890 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:15:43,894 - INFO - Para 'minimum_nights':
2025-05-17 01:15:43,894 - INFO -   - Número de valores < 1: 13
2025-05-17 01:15:43,894 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:15:43,895 - INFO -   - Número de valores > 365: 35
2025-05-17 01:15:43,895 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:15:43,902 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:15:43,906 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:15:43,908 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:15:43,975 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:15:43,976 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:15:43,999 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:15:44,000 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:15:44,020 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:15:44,030 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:15:44,045 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:15:44,077 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:15:44,118 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:15:44,142 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:15:44,181 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:15:44,208 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:15:44,235 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:15:44,249 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:15:44,277 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:15:44,285 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:15:44,298 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:15:44,298 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:15:44,307 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:15:44,308 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:15:44,310 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:15:44,311 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:15:44,325 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:15:44,329 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:15:44,331 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:15:44,344 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:15:44,346 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:15:44,348 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:15:44,350 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:15:44,379 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:15:44,381 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:15:44,383 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:15:44,384 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:15:44,390 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:15:44,403 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:15:44,415 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:15:44,421 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:17:07,828 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:17:07,831 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 0
2025-05-17 01:17:07,831 - INFO - No hay nulos que imputar en 'reviews_per_month'.
2025-05-17 01:17:13,020 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:17:13,021 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:17:13,029 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:17:13,030 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:17:13,031 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:17:13,033 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:17:13,132 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:17:13,133 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:17:13,994 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:17:13,995 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:17:13,995 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:17:14,027 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:17:14,033 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:17:14,035 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:17:14,284 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:17:14,543 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:17:14,543 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:17:14,544 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:17:14,549 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:17:14,551 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:17:14,552 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:17:14,577 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:17:14,638 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:17:14,781 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:17:14,938 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:17:14,940 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:17:14,977 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:17:15,016 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:17:15,018 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:17:15,058 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:17:15,096 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:17:15,143 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:17:15,143 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:17:15,149 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:17:15,233 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:17:15,328 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:17:15,377 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:17:15,443 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:17:15,481 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:17:15,482 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:17:15,574 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:17:15,662 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:17:15,754 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:17:15,757 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:17:15,758 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:17:15,852 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:17:15,853 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:17:15,861 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:17:16,034 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:17:16,044 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:17:16,045 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:17:16,081 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:17:16,183 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:17:16,283 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:17:16,289 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:17:16,294 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:17:16,300 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:17:16,306 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:17:16,311 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:17:16,318 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:17:16,350 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:17:16,350 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:17:16,359 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:17:16,360 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:17:16,373 - INFO - Para 'availability_365':
2025-05-17 01:17:16,374 - INFO -   - Número de valores < 0: 431
2025-05-17 01:17:16,374 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:17:16,374 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:17:16,375 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:17:16,381 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:17:16,387 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:17:16,388 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:17:16,396 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:17:16,397 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:17:16,401 - INFO - Para 'minimum_nights':
2025-05-17 01:17:16,402 - INFO -   - Número de valores < 1: 13
2025-05-17 01:17:16,403 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:17:16,403 - INFO -   - Número de valores > 365: 35
2025-05-17 01:17:16,404 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:17:16,410 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:17:16,414 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:17:16,415 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:17:16,483 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:17:16,485 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:17:16,506 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:17:16,507 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:17:16,527 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:17:16,537 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:17:16,546 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:17:16,571 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:17:16,596 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:17:16,612 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:17:16,639 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:17:16,661 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:17:16,689 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:17:16,703 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:17:16,729 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:17:16,739 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:17:16,749 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:17:16,750 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:17:16,758 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:17:16,760 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:17:16,762 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:17:16,763 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:17:16,776 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:17:16,780 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:17:16,782 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:17:16,796 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:17:16,798 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:17:16,800 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:17:16,801 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:17:16,833 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:17:16,836 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:17:16,838 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:17:16,839 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:18:19,560 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:18:19,561 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:18:19,571 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:18:19,572 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:18:19,573 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:18:19,574 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:18:19,679 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:18:19,680 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:18:20,673 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:18:20,674 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:18:20,675 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:18:20,706 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:18:20,713 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:18:20,714 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:18:20,956 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:18:21,224 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:18:21,224 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:18:21,225 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:18:21,232 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:18:21,233 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:18:21,234 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:18:21,262 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:18:21,324 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:18:21,462 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:18:21,613 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:18:21,615 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:18:21,654 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:18:21,691 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:18:21,691 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:18:21,730 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:18:21,772 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:18:21,819 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:18:21,820 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:18:21,826 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:18:21,911 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:18:22,004 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:18:22,053 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:18:22,121 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:18:22,156 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:18:22,157 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:18:22,244 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:18:22,334 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:18:22,424 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:18:22,426 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:18:22,427 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:18:22,550 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:18:22,552 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:18:22,559 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:18:22,736 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:18:22,746 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:18:22,748 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:18:22,784 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:18:22,885 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:18:22,980 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:18:22,986 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:18:22,991 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:18:22,997 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:18:23,002 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:18:23,008 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:18:23,015 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:18:23,048 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:18:23,049 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:18:23,057 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:18:23,058 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:18:23,071 - INFO - Para 'availability_365':
2025-05-17 01:18:23,071 - INFO -   - Número de valores < 0: 431
2025-05-17 01:18:23,072 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:18:23,072 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:18:23,072 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:18:23,079 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:18:23,083 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:18:23,085 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:18:23,093 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:18:23,094 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:18:23,098 - INFO - Para 'minimum_nights':
2025-05-17 01:18:23,099 - INFO -   - Número de valores < 1: 13
2025-05-17 01:18:23,099 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:18:23,100 - INFO -   - Número de valores > 365: 35
2025-05-17 01:18:23,101 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:18:23,108 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:18:23,111 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:18:23,112 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:18:23,179 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:18:23,181 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:18:23,203 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:18:23,204 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:18:23,223 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:18:23,233 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:18:23,244 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:18:23,268 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:18:23,294 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:18:23,310 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:18:23,338 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:18:23,359 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:18:23,387 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:18:23,401 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:18:23,428 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:18:23,438 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:18:23,450 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:18:23,451 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:18:23,459 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:18:23,460 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:18:23,462 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:18:23,465 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:18:23,478 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:18:23,482 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:18:23,485 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:18:23,498 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:18:23,500 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:18:23,502 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:18:23,504 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:18:23,535 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:18:23,537 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:18:23,539 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:18:23,540 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:18:23,546 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:18:23,559 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:18:23,572 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:18:23,594 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:20:25,555 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:20:25,556 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:20:25,565 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:20:25,566 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:20:25,568 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:20:25,569 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:20:25,642 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:20:25,644 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:20:26,698 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:20:26,699 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:20:26,700 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:20:26,736 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:20:26,745 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:20:26,747 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:20:27,028 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:20:27,322 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:20:27,322 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:20:27,323 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:20:27,329 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:20:27,330 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:20:27,331 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:20:27,360 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:20:27,419 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:20:27,560 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:20:27,709 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:20:27,710 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:20:27,750 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:20:27,787 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:20:27,788 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:20:27,827 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:20:27,868 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:20:27,924 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:20:27,925 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:20:27,931 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:20:28,029 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:20:28,125 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:20:28,184 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:20:28,288 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:20:28,316 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:20:28,317 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:20:28,409 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:20:28,501 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:20:28,598 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:20:28,601 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:20:28,602 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:20:28,700 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:20:28,701 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:20:28,710 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:20:28,928 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:20:28,938 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:20:28,940 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:20:28,978 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:20:29,078 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:20:29,174 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:20:29,180 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:20:29,185 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:20:29,190 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:20:29,196 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:20:29,201 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:20:29,208 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:20:29,249 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:20:29,250 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:20:29,259 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:20:29,260 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:20:29,272 - INFO - Para 'availability_365':
2025-05-17 01:20:29,273 - INFO -   - Número de valores < 0: 431
2025-05-17 01:20:29,273 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:20:29,273 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:20:29,274 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:20:29,281 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:20:29,286 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:20:29,287 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:20:29,296 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:20:29,297 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:20:29,301 - INFO - Para 'minimum_nights':
2025-05-17 01:20:29,301 - INFO -   - Número de valores < 1: 13
2025-05-17 01:20:29,301 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:20:29,302 - INFO -   - Número de valores > 365: 35
2025-05-17 01:20:29,302 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:20:29,311 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:20:29,315 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:20:29,316 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:20:29,388 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:20:29,390 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:20:29,412 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:20:29,413 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:20:29,434 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:20:29,445 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:20:29,455 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:20:29,478 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:20:29,505 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:20:29,520 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:20:29,547 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:20:29,569 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:20:29,595 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:20:29,610 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:20:29,637 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:20:29,647 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:20:29,657 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:20:29,658 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:20:29,668 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:20:29,669 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:20:29,671 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:20:29,672 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:20:29,687 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:20:29,693 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:20:29,697 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:20:29,728 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:20:29,733 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:20:29,736 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:20:29,738 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:20:29,774 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:20:29,776 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:20:29,779 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:20:29,780 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:20:29,785 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:20:29,799 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:20:29,801 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:20:29,804 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:20:29,805 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:20:29,817 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:20:29,838 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:20:29,860 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:25:37,969 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:25:37,972 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:25:37,972 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:25:37,973 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:25:37,982 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:25:51,944 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:25:51,945 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:25:51,953 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:25:51,954 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:25:51,955 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:25:51,956 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:25:52,043 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:25:52,047 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:25:52,898 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:25:52,898 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:25:52,899 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:25:52,930 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:25:52,937 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:25:52,938 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:25:53,186 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:25:53,475 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:25:53,476 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:25:53,477 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:25:53,484 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:25:53,485 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:25:53,486 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:25:53,502 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:25:53,564 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:25:53,714 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:25:53,871 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:25:53,873 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:25:53,916 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:25:53,958 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:25:53,959 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:25:54,000 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:25:54,040 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:25:54,093 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:25:54,093 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:25:54,102 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:25:54,193 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:25:54,297 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:25:54,354 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:25:54,437 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:25:54,499 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:25:54,500 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:25:54,615 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:25:54,712 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:25:54,803 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:25:54,806 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:25:54,806 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:25:54,905 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:25:54,906 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:25:54,915 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:25:55,087 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:25:55,098 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:25:55,100 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:25:55,138 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:25:55,249 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:25:55,350 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:25:55,356 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:25:55,362 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:25:55,368 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:25:55,373 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:25:55,379 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:25:55,389 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:25:55,433 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:25:55,434 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:25:55,452 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:25:55,454 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:25:55,475 - INFO - Para 'availability_365':
2025-05-17 01:25:55,476 - INFO -   - Número de valores < 0: 431
2025-05-17 01:25:55,477 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:25:55,478 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:25:55,478 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:25:55,492 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:25:55,498 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:25:55,500 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:25:55,508 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:25:55,510 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:25:55,513 - INFO - Para 'minimum_nights':
2025-05-17 01:25:55,514 - INFO -   - Número de valores < 1: 13
2025-05-17 01:25:55,515 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:25:55,515 - INFO -   - Número de valores > 365: 35
2025-05-17 01:25:55,516 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:25:55,524 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:25:55,528 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:25:55,530 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:25:55,605 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:25:55,607 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:25:55,635 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:25:55,636 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:25:55,663 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:25:55,674 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:25:55,685 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:25:55,709 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:25:55,737 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:25:55,753 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:25:55,780 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:25:55,803 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:25:55,830 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:25:55,845 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:25:55,872 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:25:55,882 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:25:55,893 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:25:55,893 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:25:55,903 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:25:55,905 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:25:55,907 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:25:55,908 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:25:55,923 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:25:55,926 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:25:55,928 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:25:55,953 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:25:55,955 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:25:55,957 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:25:55,959 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:25:55,991 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:25:55,993 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:25:55,996 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:25:55,997 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:25:56,002 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:25:56,015 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:25:56,017 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:25:56,020 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:25:56,022 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:25:56,037 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:25:56,039 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:25:56,039 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:25:56,040 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:25:56,042 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:25:56,065 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:25:56,094 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:25:56,118 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:26:59,485 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:26:59,486 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:26:59,495 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:26:59,496 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:26:59,498 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:26:59,498 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:26:59,563 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:26:59,564 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:27:00,606 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:27:00,607 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:27:00,608 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:27:00,647 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:27:00,655 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:27:00,657 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:27:00,913 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:27:01,177 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:27:01,178 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:27:01,178 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:27:01,185 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:27:01,186 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:27:01,186 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:27:01,207 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:27:01,269 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:27:01,409 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:27:01,557 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:27:01,558 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:27:01,598 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:27:01,635 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:27:01,635 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:27:01,674 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:27:01,713 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:27:01,759 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:27:01,759 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:27:01,766 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:27:01,851 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:27:01,945 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:27:01,993 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:27:02,063 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:27:02,100 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:27:02,101 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:27:02,230 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:27:02,323 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:27:02,420 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:27:02,424 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:27:02,424 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:27:02,523 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:27:02,524 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:27:02,533 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:27:02,714 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:27:02,723 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:27:02,725 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:27:02,762 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:27:02,864 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:27:02,965 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:27:02,970 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:27:02,976 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:27:02,981 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:27:02,987 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:27:02,993 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:27:03,000 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:27:03,050 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:27:03,051 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:27:03,066 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:27:03,067 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:27:03,083 - INFO - Para 'availability_365':
2025-05-17 01:27:03,084 - INFO -   - Número de valores < 0: 431
2025-05-17 01:27:03,085 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:27:03,086 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:27:03,087 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:27:03,097 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:27:03,102 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:27:03,103 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:27:03,112 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:27:03,113 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:27:03,117 - INFO - Para 'minimum_nights':
2025-05-17 01:27:03,117 - INFO -   - Número de valores < 1: 13
2025-05-17 01:27:03,118 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:27:03,118 - INFO -   - Número de valores > 365: 35
2025-05-17 01:27:03,118 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:27:03,125 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:27:03,129 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:27:03,131 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:27:03,202 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:27:03,204 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:27:03,224 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:27:03,225 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:27:03,245 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:27:03,255 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:27:03,267 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:27:03,293 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:27:03,320 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:27:03,336 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:27:03,363 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:27:03,386 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:27:03,413 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:27:03,426 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:27:03,453 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:27:03,462 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:27:03,473 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:27:03,473 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:27:03,482 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:27:03,484 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:27:03,486 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:27:03,487 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:27:03,501 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:27:03,505 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:27:03,507 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:27:03,521 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:27:03,523 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:27:03,525 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:27:03,527 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:27:03,572 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:27:03,574 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:27:03,576 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:27:03,577 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:27:03,583 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:27:03,600 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:27:03,603 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:27:03,606 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:27:03,607 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:27:03,622 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:27:03,624 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:27:03,624 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:27:03,625 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:27:03,628 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:27:03,644 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:27:03,646 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:27:03,648 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:27:03,651 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:27:03,671 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:27:03,697 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:27:03,709 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:28:34,442 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:28:34,443 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:28:34,451 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:28:34,452 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:28:34,453 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:28:34,454 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:28:34,539 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:28:34,541 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:28:35,539 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:28:35,540 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:28:35,541 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:28:35,581 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:28:35,588 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:28:35,590 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:28:35,836 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:28:36,118 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:28:36,118 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:28:36,119 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:28:36,126 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:28:36,128 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:28:36,128 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:28:36,158 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:28:36,231 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:28:36,394 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:28:36,570 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:28:36,571 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:28:36,616 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:28:36,655 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:28:36,656 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:28:36,699 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:28:36,746 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:28:36,801 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:28:36,802 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:28:36,809 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:28:36,908 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:28:37,005 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:28:37,056 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:28:37,124 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:28:37,163 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:28:37,164 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:28:37,251 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:28:37,343 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:28:37,443 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:28:37,445 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:28:37,446 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:28:37,546 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:28:37,547 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:28:37,555 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:28:37,787 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:28:37,805 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:28:37,807 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:28:37,844 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:28:37,946 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:28:38,043 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:28:38,049 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:28:38,054 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:28:38,059 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:28:38,064 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:28:38,069 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:28:38,076 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:28:38,110 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:28:38,111 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:28:38,119 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:28:38,121 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:28:38,133 - INFO - Para 'availability_365':
2025-05-17 01:28:38,134 - INFO -   - Número de valores < 0: 431
2025-05-17 01:28:38,134 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:28:38,134 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:28:38,135 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:28:38,142 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:28:38,146 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:28:38,147 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:28:38,155 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:28:38,157 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:28:38,161 - INFO - Para 'minimum_nights':
2025-05-17 01:28:38,161 - INFO -   - Número de valores < 1: 13
2025-05-17 01:28:38,162 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:28:38,162 - INFO -   - Número de valores > 365: 35
2025-05-17 01:28:38,163 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:28:38,170 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:28:38,175 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:28:38,176 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:28:38,251 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:28:38,253 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:28:38,279 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:28:38,281 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:28:38,303 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:28:38,314 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:28:38,325 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:28:38,349 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:28:38,380 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:28:38,398 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:28:38,427 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:28:38,451 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:28:38,480 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:28:38,496 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:28:38,525 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:28:38,538 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:28:38,555 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:28:38,557 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:28:38,590 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:28:38,596 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:28:38,599 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:28:38,604 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:28:38,661 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:28:38,668 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:28:38,673 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:28:38,699 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:28:38,703 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:28:38,706 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:28:38,709 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:28:38,769 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:28:38,773 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:28:38,777 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:28:38,777 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:28:38,784 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:28:38,805 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:28:38,807 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:28:38,812 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:28:38,813 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:28:38,837 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:28:38,840 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:28:38,841 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:28:38,842 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:28:38,845 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:28:38,870 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:28:38,873 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:28:38,876 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:28:38,878 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:28:38,904 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:28:38,908 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:28:41,198 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:28:41,209 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:28:41,228 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:28:41,239 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:30:18,487 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:30:18,488 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:30:18,496 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:30:18,498 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:30:18,499 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:30:18,501 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:30:18,565 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:30:18,566 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:30:19,532 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:30:19,533 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:30:19,535 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:30:19,574 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:30:19,582 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:30:19,585 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:30:19,852 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:30:20,136 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:30:20,137 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:30:20,138 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:30:20,144 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:30:20,146 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:30:20,146 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:30:20,157 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:30:20,228 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:30:20,381 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:30:20,526 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:30:20,527 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:30:20,564 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:30:20,600 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:30:20,600 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:30:20,638 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:30:20,676 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:30:20,722 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:30:20,723 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:30:20,729 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:30:20,856 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:30:20,957 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:30:21,008 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:30:21,076 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:30:21,112 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:30:21,113 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:30:21,203 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:30:21,292 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:30:21,384 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:30:21,387 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:30:21,387 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:30:21,481 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:30:21,482 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:30:21,491 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:30:21,663 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:30:21,674 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:30:21,675 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:30:21,713 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:30:21,811 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:30:21,908 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:30:21,913 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:30:21,918 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:30:21,924 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:30:21,929 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:30:21,934 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:30:21,942 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:30:21,977 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:30:21,977 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:30:21,987 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:30:21,988 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:30:21,999 - INFO - Para 'availability_365':
2025-05-17 01:30:21,999 - INFO -   - Número de valores < 0: 431
2025-05-17 01:30:22,000 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:30:22,000 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:30:22,001 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:30:22,008 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:30:22,012 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:30:22,013 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:30:22,022 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:30:22,024 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:30:22,027 - INFO - Para 'minimum_nights':
2025-05-17 01:30:22,028 - INFO -   - Número de valores < 1: 13
2025-05-17 01:30:22,028 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:30:22,029 - INFO -   - Número de valores > 365: 35
2025-05-17 01:30:22,029 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:30:22,036 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:30:22,040 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:30:22,042 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:30:22,118 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:30:22,121 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:30:22,143 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:30:22,144 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:30:22,165 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:30:22,176 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:30:22,188 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:30:22,212 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:30:22,241 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:30:22,257 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:30:22,283 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:30:22,305 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:30:22,332 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:30:22,347 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:30:22,373 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:30:22,382 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:30:22,394 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:30:22,394 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:30:22,404 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:30:22,406 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:30:22,408 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:30:22,410 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:30:22,424 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:30:22,428 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:30:22,430 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:30:22,444 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:30:22,445 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:30:22,447 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:30:22,449 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:30:22,480 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:30:22,481 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:30:22,485 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:30:22,485 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:30:22,490 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:30:22,504 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:30:22,506 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:30:22,509 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:30:22,510 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:30:22,526 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:30:22,527 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:30:22,528 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:30:22,528 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:30:22,530 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:30:22,547 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:30:22,549 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:30:22,550 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:30:22,552 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:30:22,571 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:30:22,573 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:30:24,650 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:30:24,662 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:30:24,664 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:30:24,667 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:30:24,669 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:30:24,686 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:30:24,704 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:30:24,713 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:31:26,049 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:31:26,050 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:31:26,059 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:31:26,060 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:31:26,062 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:31:26,063 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:31:26,146 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:31:26,148 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:31:27,192 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:31:27,193 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:31:27,193 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:31:27,225 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:31:27,232 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:31:27,233 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:31:27,491 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:31:27,794 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:31:27,794 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:31:27,795 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:31:27,802 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:31:27,804 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:31:27,804 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:31:27,833 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:31:27,906 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:31:28,048 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:31:28,199 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:31:28,200 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:31:28,238 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:31:28,276 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:31:28,276 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:31:28,318 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:31:28,359 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:31:28,407 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:31:28,407 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:31:28,415 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:31:28,503 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:31:28,602 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:31:28,655 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:31:28,735 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:31:28,782 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:31:28,784 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:31:28,891 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:31:28,993 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:31:29,094 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:31:29,097 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:31:29,099 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:31:29,210 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:31:29,211 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:31:29,220 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:31:29,442 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:31:29,456 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:31:29,458 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:31:29,503 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:31:29,655 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:31:29,788 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:31:29,797 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:31:29,805 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:31:29,813 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:31:29,820 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:31:29,827 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:31:29,834 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:31:29,867 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:31:29,867 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:31:29,878 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:31:29,880 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:31:29,891 - INFO - Para 'availability_365':
2025-05-17 01:31:29,892 - INFO -   - Número de valores < 0: 431
2025-05-17 01:31:29,893 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:31:29,894 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:31:29,894 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:31:29,902 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:31:29,908 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:31:29,910 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:31:29,922 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:31:29,923 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:31:29,928 - INFO - Para 'minimum_nights':
2025-05-17 01:31:29,929 - INFO -   - Número de valores < 1: 13
2025-05-17 01:31:29,929 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:31:29,930 - INFO -   - Número de valores > 365: 35
2025-05-17 01:31:29,931 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:31:29,940 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:31:29,944 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:31:29,946 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:31:30,066 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:31:30,073 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:31:30,129 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:31:30,131 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:31:30,173 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:31:30,213 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:31:30,235 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:31:30,280 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:31:30,324 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:31:30,347 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:31:30,394 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:31:30,430 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:31:30,472 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:31:30,490 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:31:30,527 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:31:30,540 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:31:30,557 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:31:30,558 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:31:30,575 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:31:30,578 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:31:30,582 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:31:30,585 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:31:30,610 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:31:30,618 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:31:30,621 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:31:30,644 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:31:30,648 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:31:30,652 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:31:30,655 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:31:30,708 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:31:30,712 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:31:30,715 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:31:30,716 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:31:30,725 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:31:30,751 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:31:30,754 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:31:30,758 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:31:30,760 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:31:30,784 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:31:30,787 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:31:30,788 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:31:30,789 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:31:30,794 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:31:30,820 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:31:30,823 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:31:30,826 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:31:30,828 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:31:30,861 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:31:30,865 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:31:33,237 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:31:33,251 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:31:33,253 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:31:33,257 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:31:33,259 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:31:33,279 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:31:33,288 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:31:33,321 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:31:33,477 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:31:33,493 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:31:33,504 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:32:30,967 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:32:30,968 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:32:30,977 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:32:30,978 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:32:30,980 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:32:30,981 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:32:31,047 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:32:31,048 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:32:32,002 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:32:32,004 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:32:32,004 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:32:32,047 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:32:32,054 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:32:32,056 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:32:32,310 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:32:32,611 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:32:32,612 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:32:32,613 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:32:32,621 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:32:32,623 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:32:32,624 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:32:32,644 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:32:32,719 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:32:32,866 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:32:33,033 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:32:33,034 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:32:33,078 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:32:33,120 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:32:33,120 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:32:33,166 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:32:33,214 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:32:33,268 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:32:33,269 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:32:33,278 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:32:33,386 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:32:33,491 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:32:33,544 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:32:33,628 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:32:33,690 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:32:33,693 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:32:33,862 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:32:33,972 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:32:34,082 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:32:34,086 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:32:34,087 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:32:34,199 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:32:34,200 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:32:34,211 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:32:34,407 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:32:34,421 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:32:34,423 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:32:34,473 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:32:34,611 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:32:34,737 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:32:34,748 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:32:34,759 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:32:34,768 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:32:34,775 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:32:34,783 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:32:34,791 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:32:34,824 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:32:34,825 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:32:34,835 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:32:34,837 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:32:34,850 - INFO - Para 'availability_365':
2025-05-17 01:32:34,851 - INFO -   - Número de valores < 0: 431
2025-05-17 01:32:34,852 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:32:34,852 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:32:34,853 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:32:34,861 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:32:34,867 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:32:34,868 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:32:34,879 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:32:34,881 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:32:34,886 - INFO - Para 'minimum_nights':
2025-05-17 01:32:34,887 - INFO -   - Número de valores < 1: 13
2025-05-17 01:32:34,887 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:32:34,888 - INFO -   - Número de valores > 365: 35
2025-05-17 01:32:34,888 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:32:34,898 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:32:34,902 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:32:34,904 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:32:34,997 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:32:34,999 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:32:35,028 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:32:35,030 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:32:35,056 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:32:35,069 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:32:35,079 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:32:35,104 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:32:35,133 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:32:35,150 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:32:35,178 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:32:35,202 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:32:35,232 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:32:35,246 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:32:35,274 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:32:35,286 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:32:35,298 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:32:35,299 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:32:35,312 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:32:35,313 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:32:35,316 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:32:35,317 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:32:35,334 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:32:35,340 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:32:35,343 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:32:35,362 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:32:35,364 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:32:35,367 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:32:35,369 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:32:35,408 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:32:35,410 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:32:35,414 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:32:35,415 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:32:35,421 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:32:35,439 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:32:35,442 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:32:35,447 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:32:35,448 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:32:35,469 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:32:35,472 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:32:35,472 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:32:35,473 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:32:35,476 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:32:35,498 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:32:35,501 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:32:35,503 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:32:35,504 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:32:35,527 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:32:35,530 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:32:37,576 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:32:37,588 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:32:37,591 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:32:37,594 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:32:37,597 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:32:37,616 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:32:37,626 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:32:37,650 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:32:37,776 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:32:37,780 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:32:37,782 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:32:38,340 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:32:38,354 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:32:38,374 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:32:38,393 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:34:37,897 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:34:37,901 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:34:37,903 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:34:41,198 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:34:41,199 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:34:41,223 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:34:41,227 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:34:41,230 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:34:41,236 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:34:41,328 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:34:41,329 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:34:42,249 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:34:42,250 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:34:42,251 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:34:42,283 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:34:42,290 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:34:42,292 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:34:42,559 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:34:42,857 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:34:42,858 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:34:42,859 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:34:42,866 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:34:42,867 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:34:42,868 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:34:42,906 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:34:42,968 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:34:43,114 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:34:43,266 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:34:43,267 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:34:43,307 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:34:43,345 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:34:43,345 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:34:43,388 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:34:43,435 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:34:43,486 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:34:43,487 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:34:43,495 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:34:43,599 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:34:43,700 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:34:43,750 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:34:43,820 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:34:43,854 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:34:43,855 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:34:43,949 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:34:44,037 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:34:44,129 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:34:44,131 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:34:44,132 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:34:44,224 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:34:44,225 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:34:44,233 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:34:44,414 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:34:44,424 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:34:44,425 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:34:44,462 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:34:44,567 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:34:44,670 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:34:44,678 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:34:44,683 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:34:44,688 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:34:44,694 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:34:44,699 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:34:44,704 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:34:44,738 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:34:44,739 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:34:44,748 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:34:44,750 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:34:44,763 - INFO - Para 'availability_365':
2025-05-17 01:34:44,763 - INFO -   - Número de valores < 0: 431
2025-05-17 01:34:44,764 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:34:44,764 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:34:44,765 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:34:44,770 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:34:44,775 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:34:44,776 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:34:44,783 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:34:44,784 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:34:44,787 - INFO - Para 'minimum_nights':
2025-05-17 01:34:44,787 - INFO -   - Número de valores < 1: 13
2025-05-17 01:34:44,788 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:34:44,788 - INFO -   - Número de valores > 365: 35
2025-05-17 01:34:44,789 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:34:44,797 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:34:44,800 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:34:44,801 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:34:44,865 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:34:44,866 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:34:44,886 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:34:44,887 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:34:44,910 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:34:44,919 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:34:44,928 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:34:44,950 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:34:44,977 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:34:45,004 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:34:45,049 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:34:45,093 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:34:45,151 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:34:45,191 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:34:45,233 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:34:45,242 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:34:45,253 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:34:45,254 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:34:45,262 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:34:45,263 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:34:45,264 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:34:45,265 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:34:45,278 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:34:45,281 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:34:45,283 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:34:45,296 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:34:45,297 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:34:45,299 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:34:45,300 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:34:45,328 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:34:45,330 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:34:45,332 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:34:45,332 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:34:45,338 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:34:45,350 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:34:45,352 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:34:45,355 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:34:45,356 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:34:45,370 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:34:45,372 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:34:45,372 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:34:45,373 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:34:45,375 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:34:45,389 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:34:45,390 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:34:45,391 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:34:45,392 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:34:45,408 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:34:45,410 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:34:47,248 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:34:47,261 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:34:47,263 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:34:47,265 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:34:47,267 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:34:47,294 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:34:47,301 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:34:47,325 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:34:47,448 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:34:47,451 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:34:47,452 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:34:48,139 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:34:48,184 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:34:48,187 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:34:48,197 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:34:48,234 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:34:48,260 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:34:48,269 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:35:35,499 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:35:35,500 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:35:35,511 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:35:35,513 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:35:35,515 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:35:35,516 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:35:35,601 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:35:35,603 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:35:36,873 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:35:36,874 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:35:36,876 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:35:36,931 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:35:36,962 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:35:36,964 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:35:37,342 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:35:37,688 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:35:37,689 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:35:37,690 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:35:37,699 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:35:37,701 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:35:37,702 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:35:37,714 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:35:37,790 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:35:37,960 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:35:38,149 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:35:38,150 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:35:38,199 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:35:38,245 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:35:38,246 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:35:38,297 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:35:38,351 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:35:38,407 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:35:38,408 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:35:38,418 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:35:38,525 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:35:38,640 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:35:38,706 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:35:38,822 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:35:38,991 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:35:38,992 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:35:39,162 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:35:39,274 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:35:39,391 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:35:39,395 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:35:39,396 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:35:39,506 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:35:39,507 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:35:39,518 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:35:39,718 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:35:39,732 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:35:39,734 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:35:39,780 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:35:39,935 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:35:40,073 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:35:40,081 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:35:40,089 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:35:40,097 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:35:40,105 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:35:40,113 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:35:40,121 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:35:40,152 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:35:40,153 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:35:40,163 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:35:40,165 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:35:40,178 - INFO - Para 'availability_365':
2025-05-17 01:35:40,179 - INFO -   - Número de valores < 0: 431
2025-05-17 01:35:40,179 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:35:40,180 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:35:40,180 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:35:40,190 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:35:40,195 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:35:40,196 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:35:40,208 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:35:40,209 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:35:40,215 - INFO - Para 'minimum_nights':
2025-05-17 01:35:40,215 - INFO -   - Número de valores < 1: 13
2025-05-17 01:35:40,216 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:35:40,216 - INFO -   - Número de valores > 365: 35
2025-05-17 01:35:40,217 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:35:40,226 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:35:40,231 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:35:40,232 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:35:40,329 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:35:40,331 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:35:40,364 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:35:40,365 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:35:40,393 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:35:40,406 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:35:40,416 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:35:40,441 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:35:40,470 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:35:40,488 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:35:40,518 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:35:40,543 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:35:40,573 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:35:40,587 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:35:40,617 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:35:40,627 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:35:40,641 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:35:40,642 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:35:40,653 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:35:40,655 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:35:40,657 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:35:40,658 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:35:40,676 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:35:40,683 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:35:40,686 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:35:40,705 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:35:40,707 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:35:40,710 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:35:40,712 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:35:40,750 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:35:40,752 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:35:40,756 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:35:40,756 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:35:40,763 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:35:40,781 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:35:40,783 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:35:40,788 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:35:40,789 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:35:40,809 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:35:40,812 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:35:40,812 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:35:40,813 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:35:40,816 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:35:40,862 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:35:40,869 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:35:40,872 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:35:40,878 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:35:40,920 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:35:40,926 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:35:42,877 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:35:42,890 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:35:42,892 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:35:42,895 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:35:42,897 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:35:42,921 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:35:42,929 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:35:42,951 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:35:43,071 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:35:43,074 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:35:43,075 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:35:43,572 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:35:43,589 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:35:43,591 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:35:43,594 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:35:43,611 - INFO - Celda 12.3 (Re-ejecución): Verificando el estado final de valores nulos por columna en df_cleaning.
2025-05-17 01:35:43,626 - INFO - Tabla de estado final de nulos por columna generada y mostrada.
2025-05-17 01:35:43,635 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:35:43,649 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:35:43,655 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:36:29,535 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:36:29,538 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:36:29,547 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:36:29,548 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:36:29,550 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:36:29,551 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:36:29,648 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:36:29,651 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:36:30,662 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:36:30,663 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:36:30,663 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:36:30,695 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:36:30,704 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:36:30,706 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:36:30,952 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:36:31,222 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:36:31,223 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:36:31,223 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:36:31,229 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:36:31,230 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:36:31,231 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:36:31,248 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:36:31,311 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:36:31,452 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:36:31,604 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:36:31,605 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:36:31,644 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:36:31,682 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:36:31,683 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:36:31,723 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:36:31,764 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:36:31,813 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:36:31,814 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:36:31,821 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:36:31,908 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:36:32,005 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:36:32,054 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:36:32,124 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:36:32,161 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:36:32,162 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:36:32,249 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:36:32,341 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:36:32,432 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:36:32,435 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:36:32,436 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:36:32,530 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:36:32,531 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:36:32,539 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:36:32,728 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:36:32,740 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:36:32,741 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:36:32,779 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:36:32,880 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:36:32,978 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:36:32,984 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:36:32,989 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:36:32,995 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:36:33,000 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:36:33,005 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:36:33,011 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:36:33,046 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:36:33,047 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:36:33,054 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:36:33,056 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:36:33,066 - INFO - Para 'availability_365':
2025-05-17 01:36:33,067 - INFO -   - Número de valores < 0: 431
2025-05-17 01:36:33,068 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:36:33,068 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:36:33,069 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:36:33,079 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:36:33,084 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:36:33,085 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:36:33,094 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:36:33,096 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:36:33,099 - INFO - Para 'minimum_nights':
2025-05-17 01:36:33,100 - INFO -   - Número de valores < 1: 13
2025-05-17 01:36:33,100 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:36:33,101 - INFO -   - Número de valores > 365: 35
2025-05-17 01:36:33,101 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:36:33,109 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:36:33,112 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:36:33,114 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:36:33,179 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:36:33,180 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:36:33,202 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:36:33,203 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:36:33,223 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:36:33,232 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:36:33,242 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:36:33,267 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:36:33,294 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:36:33,311 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:36:33,338 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:36:33,360 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:36:33,387 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:36:33,400 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:36:33,428 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:36:33,438 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:36:33,450 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:36:33,451 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:36:33,460 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:36:33,462 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:36:33,464 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:36:33,465 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:36:33,478 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:36:33,483 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:36:33,485 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:36:33,499 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:36:33,502 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:36:33,503 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:36:33,506 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:36:33,540 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:36:33,542 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:36:33,544 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:36:33,545 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:36:33,549 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:36:33,564 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:36:33,566 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:36:33,570 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:36:33,571 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:36:33,588 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:36:33,591 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:36:33,591 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:36:33,592 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:36:33,595 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:36:33,613 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:36:33,615 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:36:33,616 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:36:33,618 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:36:33,635 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:36:33,638 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:36:35,563 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:36:35,575 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:36:35,577 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:36:35,580 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:36:35,581 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:36:35,598 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:36:35,606 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:36:35,628 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:36:35,778 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:36:35,780 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:36:35,782 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:36:36,236 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:36:36,251 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:36:36,253 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:36:36,256 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:36:36,270 - INFO - Celda 12.3 (Re-ejecución): Verificando el estado final de valores nulos por columna en df_cleaning.
2025-05-17 01:36:36,281 - INFO - Tabla de estado final de nulos por columna generada y mostrada.
2025-05-17 01:36:36,289 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:36:36,304 - INFO - Tabla de estado actual de nulos por columna generada y mostrada.
2025-05-17 01:36:36,310 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:37:00,067 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:37:00,069 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:37:00,077 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:37:00,078 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:37:00,079 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:37:00,080 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:37:00,168 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:37:00,169 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:37:01,078 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:37:01,079 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:37:01,080 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:37:01,112 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:37:01,120 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:37:01,121 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:37:01,365 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:37:01,643 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:37:01,643 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:37:01,644 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:37:01,652 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:37:01,653 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:37:01,654 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:37:01,673 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:37:01,742 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:37:01,888 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:37:02,052 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:37:02,054 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:37:02,097 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:37:02,138 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:37:02,139 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:37:02,179 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:37:02,221 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:37:02,274 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:37:02,275 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:37:02,281 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:37:02,375 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:37:02,472 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:37:02,526 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:37:02,595 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:37:02,637 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:37:02,638 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:37:02,726 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:37:02,814 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:37:02,917 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:37:02,922 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:37:02,922 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:37:03,058 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:37:03,059 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:37:03,066 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:37:03,243 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:37:03,254 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:37:03,256 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:37:03,293 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:37:03,395 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:37:03,495 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:37:03,501 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:37:03,506 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:37:03,512 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:37:03,518 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:37:03,523 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:37:03,529 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:37:03,563 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:37:03,563 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:37:03,572 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:37:03,573 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:37:03,587 - INFO - Para 'availability_365':
2025-05-17 01:37:03,588 - INFO -   - Número de valores < 0: 431
2025-05-17 01:37:03,589 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:37:03,589 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:37:03,589 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:37:03,596 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:37:03,601 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:37:03,602 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:37:03,610 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:37:03,612 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:37:03,615 - INFO - Para 'minimum_nights':
2025-05-17 01:37:03,616 - INFO -   - Número de valores < 1: 13
2025-05-17 01:37:03,616 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:37:03,617 - INFO -   - Número de valores > 365: 35
2025-05-17 01:37:03,617 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:37:03,624 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:37:03,628 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:37:03,629 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:37:03,698 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:37:03,699 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:37:03,721 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:37:03,722 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:37:03,742 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:37:03,751 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:37:03,763 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:37:03,786 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:37:03,813 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:37:03,830 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:37:03,856 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:37:03,878 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:37:03,905 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:37:03,918 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:37:03,947 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:37:03,957 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:37:03,968 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:37:03,969 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:37:03,977 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:37:03,979 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:37:03,982 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:37:03,983 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:37:03,996 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:37:04,001 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:37:04,003 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:37:04,016 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:37:04,019 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:37:04,021 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:37:04,022 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:37:04,054 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:37:04,056 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:37:04,058 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:37:04,059 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:37:04,063 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:37:04,076 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:37:04,078 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:37:04,081 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:37:04,082 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:37:04,097 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:37:04,100 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:37:04,101 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:37:04,101 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:37:04,104 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:37:04,118 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:37:04,120 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:37:04,122 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:37:04,123 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:37:04,142 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:37:04,144 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:37:05,843 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:37:05,853 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:37:05,855 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:37:05,857 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:37:05,859 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:37:05,881 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:37:05,889 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:37:05,913 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:37:06,021 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:37:06,023 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:37:06,025 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:37:06,506 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:37:06,519 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:37:06,521 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:37:06,523 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:37:06,538 - INFO - Celda 12.17: Iniciando imputación de nulos para 'number_of_reviews' con la media.
2025-05-17 01:37:06,540 - INFO - Nulos en 'number_of_reviews' ANTES de la imputación con media: 183
2025-05-17 01:37:06,542 - INFO - La media calculada para 'number_of_reviews' es: 27.517948466257668 (se usará como entero: 28)
2025-05-17 01:37:06,543 - INFO - Nulos en 'number_of_reviews' DESPUÉS de la imputación: 0
2025-05-17 01:37:06,556 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:37:06,568 - INFO - No se encontraron valores nulos en df_cleaning actualmente.
2025-05-17 01:37:06,574 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:40:23,797 - INFO - Celda 13: Preparando para subir df_cleaning a la nueva tabla 'cleaned_airbnb_listings' en PostgreSQL.
2025-05-17 01:40:32,571 - INFO - Celda 13: Preparando para subir df_cleaning a la nueva tabla 'cleaned_airbnb_listings' en PostgreSQL.
2025-05-17 01:42:01,075 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:42:01,077 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:42:01,087 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:42:01,089 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:42:01,093 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:42:01,095 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:42:01,202 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:42:01,203 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:42:02,133 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:42:02,134 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:42:02,134 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:42:02,168 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:42:02,176 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:42:02,177 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:42:02,460 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:42:02,804 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:42:02,805 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:42:02,805 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:42:02,812 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:42:02,814 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:42:02,815 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:42:02,835 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:42:02,918 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:42:03,077 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:42:03,246 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:42:03,247 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:42:03,297 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:42:03,340 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:42:03,341 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:42:03,383 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:42:03,426 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:42:03,484 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:42:03,484 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:42:03,491 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:42:03,600 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:42:03,697 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:42:03,748 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:42:03,834 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:42:03,891 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:42:03,893 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:42:03,990 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:42:04,092 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:42:04,198 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:42:04,202 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:42:04,202 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:42:04,326 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:42:04,327 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:42:04,336 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:42:04,564 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:42:04,581 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:42:04,582 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:42:04,618 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:42:04,728 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:42:04,837 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:42:04,845 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:42:04,851 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:42:04,856 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:42:04,865 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:42:04,874 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:42:04,883 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:42:04,916 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:42:04,917 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:42:04,926 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:42:04,928 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:42:04,944 - INFO - Para 'availability_365':
2025-05-17 01:42:04,944 - INFO -   - Número de valores < 0: 431
2025-05-17 01:42:04,945 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:42:04,945 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:42:04,946 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:42:04,952 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:42:04,956 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:42:04,959 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:42:04,968 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:42:04,970 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:42:04,974 - INFO - Para 'minimum_nights':
2025-05-17 01:42:04,975 - INFO -   - Número de valores < 1: 13
2025-05-17 01:42:04,976 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:42:04,976 - INFO -   - Número de valores > 365: 35
2025-05-17 01:42:04,977 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:42:04,985 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:42:04,989 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:42:04,991 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:42:05,068 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:42:05,070 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:42:05,094 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:42:05,094 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:42:05,114 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:42:05,125 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:42:05,135 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:42:05,158 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:42:05,184 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:42:05,202 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:42:05,231 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:42:05,255 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:42:05,284 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:42:05,299 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:42:05,328 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:42:05,337 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:42:05,350 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:42:05,351 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:42:05,359 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:42:05,361 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:42:05,363 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:42:05,364 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:42:05,377 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:42:05,381 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:42:05,383 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:42:05,399 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:42:05,400 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:42:05,402 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:42:05,404 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:42:05,435 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:42:05,437 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:42:05,440 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:42:05,441 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:42:05,446 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:42:05,461 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:42:05,463 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:42:05,466 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:42:05,468 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:42:05,484 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:42:05,486 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:42:05,486 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:42:05,487 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:42:05,490 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:42:05,505 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:42:05,508 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:42:05,510 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:42:05,511 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:42:05,528 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:42:05,531 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:42:07,493 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:42:07,504 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:42:07,506 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:42:07,510 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:42:07,511 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:42:07,528 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:42:07,536 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:42:07,558 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:42:07,674 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:42:07,676 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:42:07,677 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:42:08,126 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:42:08,139 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:42:08,142 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:42:08,144 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:42:08,159 - INFO - Celda 12.17: Iniciando imputación de nulos para 'number_of_reviews' con la media.
2025-05-17 01:42:08,161 - INFO - Nulos en 'number_of_reviews' ANTES de la imputación con media: 183
2025-05-17 01:42:08,163 - INFO - La media calculada para 'number_of_reviews' es: 27.517948466257668 (se usará como entero: 28)
2025-05-17 01:42:08,165 - INFO - Nulos en 'number_of_reviews' DESPUÉS de la imputación: 0
2025-05-17 01:42:08,177 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:42:08,189 - INFO - No se encontraron valores nulos en df_cleaning actualmente.
2025-05-17 01:42:08,231 - INFO - Celda 13: Preparando para subir df_cleaning a la nueva tabla 'cleaned_airbnb_listings' en PostgreSQL.
2025-05-17 01:42:08,281 - INFO - Celda 13.1: Definiendo esquema y creando la tabla vacía 'cleaned_airbnb_listings'.
2025-05-17 01:42:08,298 - INFO - Ejecutando: DROP TABLE IF EXISTS "cleaned_airbnb_listings";
2025-05-17 01:42:08,298 - ERROR - Error al crear la tabla 'cleaned_airbnb_listings': name 'text' is not defined
2025-05-17 01:42:08,299 - ERROR - Error en la Celda 13.1 (conexión o definición de tabla): name 'text' is not defined
2025-05-17 01:42:08,318 - INFO - Celda 13.2: Preparando df_cleaning para la carga a 'cleaned_airbnb_listings'.
2025-05-17 01:42:08,335 - INFO - df_to_upload creado con 25 columnas en el orden especificado.
2025-05-17 01:42:08,343 - INFO - Columna 'review_rate_number' (category) convertida a Int64 para la carga a SQL.
2025-05-17 01:42:08,367 - INFO - Celda 13.3: Insertando datos de df_to_upload en la tabla 'cleaned_airbnb_listings'.
2025-05-17 01:42:08,368 - INFO - Intentando insertar 102058 filas en 'cleaned_airbnb_listings'.
2025-05-17 01:42:15,219 - INFO - Datos insertados exitosamente en la tabla 'cleaned_airbnb_listings'.
2025-05-17 01:42:15,221 - INFO - Conexión del motor SQLAlchemy (engine_upload) dispuesta después de la carga.
2025-05-17 01:42:15,231 - INFO - Celda 13.4: Verificando las primeras filas de la tabla 'cleaned_airbnb_listings' desde PostgreSQL.
2025-05-17 01:42:15,233 - ERROR - Error al consultar datos desde la tabla 'cleaned_airbnb_listings' en PostgreSQL: name 'text' is not defined
2025-05-17 01:42:15,234 - INFO - Conexión del motor SQLAlchemy (engine_verify) dispuesta.
2025-05-17 01:42:15,243 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:43:52,973 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:43:52,974 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:43:52,983 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:43:52,985 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:43:52,987 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:43:52,988 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:43:53,067 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:43:53,068 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:43:54,068 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:43:54,069 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:43:54,070 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:43:54,102 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:43:54,110 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:43:54,111 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:43:54,366 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:43:54,656 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:43:54,657 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:43:54,657 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:43:54,664 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:43:54,665 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:43:54,666 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:43:54,684 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:43:54,755 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:43:54,904 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:43:55,060 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:43:55,062 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:43:55,101 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:43:55,143 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:43:55,143 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:43:55,182 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:43:55,224 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:43:55,276 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:43:55,277 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:43:55,283 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:43:55,373 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:43:55,474 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:43:55,529 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:43:55,609 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:43:55,654 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:43:55,655 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:43:55,769 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:43:55,913 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:43:56,018 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:43:56,022 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:43:56,022 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:43:56,139 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:43:56,141 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:43:56,152 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:43:56,366 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:43:56,379 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:43:56,381 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:43:56,423 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:43:56,527 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:43:56,633 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:43:56,638 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:43:56,643 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:43:56,649 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:43:56,654 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:43:56,660 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:43:56,665 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:43:56,697 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:43:56,698 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:43:56,705 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:43:56,707 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:43:56,720 - INFO - Para 'availability_365':
2025-05-17 01:43:56,721 - INFO -   - Número de valores < 0: 431
2025-05-17 01:43:56,721 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:43:56,722 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:43:56,722 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:43:56,729 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:43:56,734 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:43:56,736 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:43:56,744 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:43:56,746 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:43:56,749 - INFO - Para 'minimum_nights':
2025-05-17 01:43:56,749 - INFO -   - Número de valores < 1: 13
2025-05-17 01:43:56,750 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:43:56,751 - INFO -   - Número de valores > 365: 35
2025-05-17 01:43:56,751 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:43:56,758 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:43:56,762 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:43:56,764 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:43:56,834 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:43:56,836 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:43:56,858 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:43:56,859 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:43:56,878 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:43:56,888 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:43:56,897 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:43:56,921 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:43:56,946 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:43:56,962 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:43:56,989 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:43:57,011 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:43:57,038 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:43:57,053 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:43:57,079 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:43:57,089 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:43:57,100 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:43:57,102 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:43:57,110 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:43:57,112 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:43:57,114 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:43:57,115 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:43:57,144 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:43:57,148 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:43:57,150 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:43:57,164 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:43:57,166 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:43:57,169 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:43:57,171 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:43:57,201 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:43:57,203 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:43:57,206 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:43:57,207 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:43:57,211 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:43:57,224 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:43:57,226 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:43:57,229 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:43:57,230 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:43:57,245 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:43:57,247 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:43:57,247 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:43:57,248 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:43:57,251 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:43:57,265 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:43:57,267 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:43:57,270 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:43:57,271 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:43:57,288 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:43:57,290 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:43:59,085 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:43:59,109 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:43:59,111 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:43:59,114 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:43:59,117 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:43:59,137 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:43:59,146 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:43:59,181 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:43:59,305 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:43:59,307 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:43:59,309 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:43:59,830 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:43:59,844 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:43:59,846 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:43:59,848 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:43:59,863 - INFO - Celda 12.17: Iniciando imputación de nulos para 'number_of_reviews' con la media.
2025-05-17 01:43:59,864 - INFO - Nulos en 'number_of_reviews' ANTES de la imputación con media: 183
2025-05-17 01:43:59,866 - INFO - La media calculada para 'number_of_reviews' es: 27.517948466257668 (se usará como entero: 28)
2025-05-17 01:43:59,868 - INFO - Nulos en 'number_of_reviews' DESPUÉS de la imputación: 0
2025-05-17 01:43:59,880 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:43:59,892 - INFO - No se encontraron valores nulos en df_cleaning actualmente.
2025-05-17 01:43:59,924 - INFO - Celda 13: Preparando para subir df_cleaning a la nueva tabla 'cleaned_airbnb_listings' en PostgreSQL.
2025-05-17 01:43:59,937 - INFO - Celda 13.1: Definiendo esquema y creando la tabla vacía 'cleaned_airbnb_listings'.
2025-05-17 01:43:59,945 - INFO - Ejecutando: DROP TABLE IF EXISTS "cleaned_airbnb_listings";
2025-05-17 01:43:59,947 - INFO - Tabla 'cleaned_airbnb_listings' eliminada si existía.
2025-05-17 01:43:59,948 - INFO - Ejecutando: 
    CREATE TABLE IF NOT EXISTS "cleaned_airbnb_listings" (
        "id" BIGINT PRIMARY KEY, "name" TEXT, "host_id" BIGINT, "neighbourhood_group" TEXT, "neighbourhood" TEXT, "lat" DOUBLE PRECISION, "long" DOUBLE PRECISION, "country" TEXT, "country_code" TEXT, "cancellation_policy" TEXT, "room_type" TEXT, "construction_year" INTEGER, "price" DOUBLE PRECISION, "service_fee" DOUBLE PRECISION, "minimum_nights" INTEGER, "number_of_reviews" INTEGER, "last_review" TIMESTAMP WITHOUT TIME ZONE, "reviews_per_month" DOUBLE PRECISION, "review_rate_number" INTEGER, "calculated_host_listings_count" INTEGER, "availability_365" INTEGER, "is_host_unconfirmed" BOOLEAN, "is_host_verified" BOOLEAN, "is_instant_bookable_false_policy" BOOLEAN, "is_instant_bookable_true_policy" BOOLEAN
    );
    
2025-05-17 01:43:59,956 - INFO - Tabla vacía 'cleaned_airbnb_listings' creada exitosamente con el esquema definido.
2025-05-17 01:43:59,966 - INFO - Celda 13.2: Preparando df_cleaning para la carga a 'cleaned_airbnb_listings'.
2025-05-17 01:43:59,987 - INFO - df_to_upload creado con 25 columnas en el orden especificado.
2025-05-17 01:43:59,994 - INFO - Columna 'review_rate_number' (category) convertida a Int64 para la carga a SQL.
2025-05-17 01:44:00,019 - INFO - Celda 13.3: Insertando datos de df_to_upload en la tabla 'cleaned_airbnb_listings'.
2025-05-17 01:44:00,021 - INFO - Intentando insertar 102058 filas en 'cleaned_airbnb_listings'.
2025-05-17 01:44:07,052 - INFO - Datos insertados exitosamente en la tabla 'cleaned_airbnb_listings'.
2025-05-17 01:44:07,053 - INFO - Conexión del motor SQLAlchemy (engine_upload) dispuesta después de la carga.
2025-05-17 01:44:07,062 - INFO - Celda 13.4: Verificando las primeras filas de la tabla 'cleaned_airbnb_listings' desde PostgreSQL.
2025-05-17 01:44:07,077 - INFO - Primeras 5 filas obtenidas de 'cleaned_airbnb_listings' en PostgreSQL:
2025-05-17 01:44:07,080 - INFO - Conexión del motor SQLAlchemy (engine_verify) dispuesta.
2025-05-17 01:44:07,088 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:45:12,214 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:45:12,215 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:45:12,228 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:45:12,232 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:45:12,234 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:45:12,235 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:45:12,331 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:45:12,332 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:45:13,174 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:45:13,175 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:45:13,176 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:45:13,205 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:45:13,212 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:45:13,213 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:45:13,455 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:45:13,718 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:45:13,719 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:45:13,719 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:45:13,725 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:45:13,726 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:45:13,727 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:45:13,744 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:45:13,805 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:45:13,942 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:45:14,091 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:45:14,092 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:45:14,129 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:45:14,166 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:45:14,167 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:45:14,204 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:45:14,244 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:45:14,292 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:45:14,293 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:45:14,300 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:45:14,385 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:45:14,479 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:45:14,527 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:45:14,596 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:45:14,632 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:45:14,633 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:45:14,721 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:45:14,807 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:45:14,894 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:45:14,897 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:45:14,898 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:45:14,991 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:45:14,992 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:45:15,001 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:45:15,171 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:45:15,180 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:45:15,182 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:45:15,218 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:45:15,314 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:45:15,411 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:45:15,417 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:45:15,422 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:45:15,427 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:45:15,433 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:45:15,438 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:45:15,445 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:45:15,477 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:45:15,478 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:45:15,486 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:45:15,487 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:45:15,497 - INFO - Para 'availability_365':
2025-05-17 01:45:15,498 - INFO -   - Número de valores < 0: 431
2025-05-17 01:45:15,499 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:45:15,500 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:45:15,500 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:45:15,507 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:45:15,512 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:45:15,513 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:45:15,521 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:45:15,523 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:45:15,526 - INFO - Para 'minimum_nights':
2025-05-17 01:45:15,527 - INFO -   - Número de valores < 1: 13
2025-05-17 01:45:15,527 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:45:15,527 - INFO -   - Número de valores > 365: 35
2025-05-17 01:45:15,528 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:45:15,535 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:45:15,540 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:45:15,545 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:45:15,639 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:45:15,641 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:45:15,661 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:45:15,661 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:45:15,681 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:45:15,691 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:45:15,702 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:45:15,724 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:45:15,750 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:45:15,766 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:45:15,793 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:45:15,816 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:45:15,842 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:45:15,856 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:45:15,881 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:45:15,890 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:45:15,902 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:45:15,903 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:45:15,912 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:45:15,914 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:45:15,916 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:45:15,917 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:45:15,929 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:45:15,933 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:45:15,936 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:45:15,950 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:45:15,952 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:45:15,953 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:45:15,955 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:45:15,986 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:45:15,989 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:45:15,991 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:45:15,991 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:45:15,995 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:45:16,008 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:45:16,010 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:45:16,013 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:45:16,014 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:45:16,030 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:45:16,032 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:45:16,033 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:45:16,033 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:45:16,036 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:45:16,051 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:45:16,053 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:45:16,055 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:45:16,057 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:45:16,072 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:45:16,074 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:45:17,812 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:45:17,825 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:45:17,826 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:45:17,829 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:45:17,830 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:45:17,847 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:45:17,854 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:45:17,875 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:45:17,981 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:45:17,984 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:45:17,986 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:45:18,405 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:45:18,418 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:45:18,420 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:45:18,422 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:45:18,437 - INFO - Celda 12.17: Iniciando imputación de nulos para 'number_of_reviews' con la media.
2025-05-17 01:45:18,439 - INFO - Nulos en 'number_of_reviews' ANTES de la imputación con media: 183
2025-05-17 01:45:18,440 - INFO - La media calculada para 'number_of_reviews' es: 27.517948466257668 (se usará como entero: 28)
2025-05-17 01:45:18,442 - INFO - Nulos en 'number_of_reviews' DESPUÉS de la imputación: 0
2025-05-17 01:45:18,454 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:45:18,465 - INFO - No se encontraron valores nulos en df_cleaning actualmente.
2025-05-17 01:45:18,497 - INFO - Celda 13: Preparando para subir df_cleaning a la nueva tabla 'cleaned_airbnb_listings' en PostgreSQL.
2025-05-17 01:45:18,509 - INFO - Celda 13.1: Definiendo esquema y creando la tabla vacía 'cleaned_airbnb_listings'.
2025-05-17 01:45:18,519 - INFO - Ejecutando: DROP TABLE IF EXISTS "cleaned_airbnb_listings";
2025-05-17 01:45:18,520 - INFO - Tabla 'cleaned_airbnb_listings' eliminada si existía.
2025-05-17 01:45:18,521 - INFO - Ejecutando: 
    CREATE TABLE IF NOT EXISTS "cleaned_airbnb_listings" (
        "id" BIGINT PRIMARY KEY, "name" TEXT, "host_id" BIGINT, "neighbourhood_group" TEXT, "neighbourhood" TEXT, "lat" DOUBLE PRECISION, "long" DOUBLE PRECISION, "country" TEXT, "country_code" TEXT, "cancellation_policy" TEXT, "room_type" TEXT, "construction_year" INTEGER, "price" DOUBLE PRECISION, "service_fee" DOUBLE PRECISION, "minimum_nights" INTEGER, "number_of_reviews" INTEGER, "last_review" TIMESTAMP WITHOUT TIME ZONE, "reviews_per_month" DOUBLE PRECISION, "review_rate_number" INTEGER, "calculated_host_listings_count" INTEGER, "availability_365" INTEGER, "is_host_unconfirmed" BOOLEAN, "is_host_verified" BOOLEAN, "is_instant_bookable_false_policy" BOOLEAN, "is_instant_bookable_true_policy" BOOLEAN
    );
    
2025-05-17 01:45:18,527 - INFO - Tabla vacía 'cleaned_airbnb_listings' creada exitosamente con el esquema definido.
2025-05-17 01:45:18,535 - INFO - Celda 13.2: Preparando df_cleaning para la carga a 'cleaned_airbnb_listings'.
2025-05-17 01:45:18,552 - INFO - df_to_upload creado con 25 columnas en el orden especificado.
2025-05-17 01:45:18,558 - INFO - Columna 'review_rate_number' (category) convertida a Int64 para la carga a SQL.
2025-05-17 01:45:18,581 - INFO - Celda 13.3: Insertando datos de df_to_upload en la tabla 'cleaned_airbnb_listings'.
2025-05-17 01:45:18,582 - INFO - Intentando insertar 102058 filas en 'cleaned_airbnb_listings'.
2025-05-17 01:45:23,848 - INFO - Datos insertados exitosamente en la tabla 'cleaned_airbnb_listings'.
2025-05-17 01:45:23,849 - INFO - Conexión del motor SQLAlchemy (engine_upload) dispuesta después de la carga.
2025-05-17 01:45:23,857 - INFO - Celda 13.4: Verificando las primeras filas de la tabla 'cleaned_airbnb_listings' desde PostgreSQL.
2025-05-17 01:45:23,869 - INFO - Primeras 5 filas obtenidas de 'cleaned_airbnb_listings' en PostgreSQL:
2025-05-17 01:45:23,872 - INFO - Conexión del motor SQLAlchemy (engine_verify) dispuesta.
2025-05-17 01:45:23,879 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:49:38,756 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:49:38,757 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:49:38,766 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:49:38,767 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:49:38,769 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:49:38,770 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:49:38,850 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:49:38,851 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:49:39,762 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:49:39,763 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:49:39,763 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:49:39,799 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:49:39,808 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:49:39,809 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:49:40,114 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:49:40,407 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:49:40,407 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:49:40,408 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:49:40,416 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:49:40,417 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:49:40,418 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:49:40,424 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:49:40,495 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:49:40,661 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:49:40,817 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:49:40,818 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:49:40,862 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:49:40,904 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:49:40,905 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:49:40,948 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:49:40,992 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:49:41,048 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:49:41,049 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:49:41,055 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:49:41,151 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:49:41,249 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:49:41,298 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:49:41,371 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:49:41,411 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:49:41,412 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:49:41,510 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:49:41,602 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:49:41,693 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:49:41,695 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:49:41,696 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:49:41,787 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:49:41,788 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:49:41,795 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:49:41,961 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:49:41,982 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:49:41,984 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:49:42,033 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:49:42,179 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:49:42,282 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:49:42,288 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:49:42,294 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:49:42,299 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:49:42,306 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:49:42,312 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:49:42,318 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:49:42,352 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:49:42,353 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:49:42,362 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:49:42,363 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:49:42,375 - INFO - Para 'availability_365':
2025-05-17 01:49:42,376 - INFO -   - Número de valores < 0: 431
2025-05-17 01:49:42,377 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:49:42,377 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:49:42,377 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:49:42,383 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:49:42,388 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:49:42,390 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:49:42,398 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:49:42,399 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:49:42,404 - INFO - Para 'minimum_nights':
2025-05-17 01:49:42,404 - INFO -   - Número de valores < 1: 13
2025-05-17 01:49:42,405 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:49:42,405 - INFO -   - Número de valores > 365: 35
2025-05-17 01:49:42,406 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:49:42,412 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:49:42,416 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:49:42,417 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:49:42,481 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:49:42,483 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:49:42,505 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:49:42,506 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:49:42,524 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:49:42,533 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:49:42,544 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:49:42,567 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:49:42,594 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:49:42,610 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:49:42,637 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:49:42,659 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:49:42,685 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:49:42,699 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:49:42,726 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:49:42,735 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:49:42,747 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:49:42,748 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:49:42,766 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:49:42,767 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:49:42,769 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:49:42,770 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:49:42,783 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:49:42,787 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:49:42,790 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:49:42,806 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:49:42,808 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:49:42,810 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:49:42,812 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:49:42,845 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:49:42,847 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:49:42,849 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:49:42,850 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:49:42,856 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:49:42,869 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:49:42,871 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:49:42,875 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:49:42,877 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:49:42,892 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:49:42,894 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:49:42,894 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:49:42,894 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:49:42,897 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:49:42,912 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:49:42,914 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:49:42,916 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:49:42,917 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:49:42,996 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:49:42,999 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:49:44,751 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:49:44,762 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:49:44,764 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:49:44,767 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:49:44,768 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:49:44,783 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:49:44,792 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:49:44,813 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:49:44,918 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:49:44,920 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:49:44,922 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:49:45,362 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:49:45,376 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:49:45,378 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:49:45,379 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:49:45,411 - INFO - Celda 12.17: Iniciando imputación de nulos para 'number_of_reviews' con la media.
2025-05-17 01:49:45,412 - INFO - Nulos en 'number_of_reviews' ANTES de la imputación con media: 183
2025-05-17 01:49:45,414 - INFO - La media calculada para 'number_of_reviews' es: 27.517948466257668 (se usará como entero: 28)
2025-05-17 01:49:45,415 - INFO - Nulos en 'number_of_reviews' DESPUÉS de la imputación: 0
2025-05-17 01:49:45,426 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:49:45,439 - INFO - No se encontraron valores nulos en df_cleaning actualmente.
2025-05-17 01:49:45,486 - INFO - Celda 13: Preparando para subir df_cleaning a la nueva tabla 'cleaned_airbnb_listings' en PostgreSQL.
2025-05-17 01:49:45,499 - INFO - Celda 13.1: Definiendo esquema y creando la tabla vacía 'cleaned_airbnb_listings'.
2025-05-17 01:49:45,510 - INFO - Ejecutando: DROP TABLE IF EXISTS "cleaned_airbnb_listings";
2025-05-17 01:49:45,512 - INFO - Tabla 'cleaned_airbnb_listings' eliminada si existía.
2025-05-17 01:49:45,513 - INFO - Ejecutando: 
    CREATE TABLE IF NOT EXISTS "cleaned_airbnb_listings" (
        "id" BIGINT PRIMARY KEY, "name" TEXT, "host_id" BIGINT, "neighbourhood_group" TEXT, "neighbourhood" TEXT, "lat" DOUBLE PRECISION, "long" DOUBLE PRECISION, "country" TEXT, "country_code" TEXT, "cancellation_policy" TEXT, "room_type" TEXT, "construction_year" INTEGER, "price" DOUBLE PRECISION, "service_fee" DOUBLE PRECISION, "minimum_nights" INTEGER, "number_of_reviews" INTEGER, "last_review" TIMESTAMP WITHOUT TIME ZONE, "reviews_per_month" DOUBLE PRECISION, "review_rate_number" INTEGER, "calculated_host_listings_count" INTEGER, "availability_365" INTEGER, "is_host_unconfirmed" BOOLEAN, "is_host_verified" BOOLEAN, "is_instant_bookable_false_policy" BOOLEAN, "is_instant_bookable_true_policy" BOOLEAN
    );
    
2025-05-17 01:49:45,520 - INFO - Tabla vacía 'cleaned_airbnb_listings' creada exitosamente con el esquema definido.
2025-05-17 01:49:45,530 - INFO - Celda 13.2: Preparando df_cleaning para la carga a 'cleaned_airbnb_listings'.
2025-05-17 01:49:45,532 - ERROR - Faltan las siguientes columnas en df_cleaning para la carga: ['country_code']
2025-05-17 01:51:15,839 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 01:51:15,840 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 01:51:15,853 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:51:15,856 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 01:51:15,858 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 01:51:15,861 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 01:51:15,949 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 01:51:15,950 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 01:51:16,915 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 01:51:16,915 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 01:51:16,916 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 01:51:16,956 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 01:51:16,963 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 01:51:16,965 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 01:51:17,243 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 01:51:17,527 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 01:51:17,528 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 01:51:17,528 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 01:51:17,535 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 01:51:17,537 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 01:51:17,537 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 01:51:17,548 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:51:17,605 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 01:51:17,751 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 01:51:17,902 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 01:51:17,904 - INFO - Procesando 'host_identity_verified'.
2025-05-17 01:51:17,943 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 01:51:17,983 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 01:51:17,984 - INFO - Procesando 'instant_bookable'.
2025-05-17 01:51:18,026 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 01:51:18,066 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 01:51:18,120 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 01:51:18,121 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 01:51:18,127 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 01:51:18,211 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 01:51:18,304 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 01:51:18,353 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 01:51:18,422 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 01:51:18,460 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 01:51:18,461 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 01:51:18,563 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 01:51:18,686 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 01:51:18,789 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 01:51:18,792 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 01:51:18,793 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 01:51:18,896 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 01:51:18,897 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 01:51:18,904 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 01:51:19,082 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 01:51:19,094 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 01:51:19,095 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 01:51:19,135 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 01:51:19,250 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 01:51:19,349 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 01:51:19,355 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 01:51:19,359 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 01:51:19,365 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 01:51:19,370 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 01:51:19,375 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 01:51:19,382 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 01:51:19,412 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 01:51:19,413 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 01:51:19,421 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 01:51:19,423 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 01:51:19,435 - INFO - Para 'availability_365':
2025-05-17 01:51:19,436 - INFO -   - Número de valores < 0: 431
2025-05-17 01:51:19,436 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 01:51:19,437 - INFO -   - Número de valores > 365: 2754
2025-05-17 01:51:19,437 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 01:51:19,444 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 01:51:19,449 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 01:51:19,450 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 01:51:19,459 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 01:51:19,460 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 01:51:19,463 - INFO - Para 'minimum_nights':
2025-05-17 01:51:19,464 - INFO -   - Número de valores < 1: 13
2025-05-17 01:51:19,465 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 01:51:19,466 - INFO -   - Número de valores > 365: 35
2025-05-17 01:51:19,466 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 01:51:19,474 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 01:51:19,477 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 01:51:19,478 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 01:51:19,551 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 01:51:19,553 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 01:51:19,577 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 01:51:19,577 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 01:51:19,604 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 01:51:19,614 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 01:51:19,624 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 01:51:19,650 - INFO - La moda para 'country' es: 'United States'
2025-05-17 01:51:19,679 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 01:51:19,696 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 01:51:19,726 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 01:51:19,750 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 01:51:19,779 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 01:51:19,794 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 01:51:19,823 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 01:51:19,831 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 01:51:19,844 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 01:51:19,845 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 01:51:19,855 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 01:51:19,857 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 01:51:19,859 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 01:51:19,860 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 01:51:19,873 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 01:51:19,877 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 01:51:19,880 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 01:51:19,894 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 01:51:19,896 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 01:51:19,898 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 01:51:19,900 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 01:51:19,950 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 01:51:19,959 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 01:51:19,964 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 01:51:19,966 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 01:51:19,975 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 01:51:19,997 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 01:51:19,999 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 01:51:20,003 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 01:51:20,005 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 01:51:20,027 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 01:51:20,029 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 01:51:20,030 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 01:51:20,031 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 01:51:20,035 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 01:51:20,053 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 01:51:20,055 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 01:51:20,056 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 01:51:20,058 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 01:51:20,076 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 01:51:20,078 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 01:51:21,801 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 01:51:21,814 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 01:51:21,816 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 01:51:21,819 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 01:51:21,821 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 01:51:21,839 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 01:51:21,846 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 01:51:21,865 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 01:51:21,982 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 01:51:21,985 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 01:51:21,987 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 01:51:22,474 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 01:51:22,488 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 01:51:22,491 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 01:51:22,493 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 01:51:22,511 - INFO - Celda 12.17: Iniciando imputación de nulos para 'number_of_reviews' con la media.
2025-05-17 01:51:22,512 - INFO - Nulos en 'number_of_reviews' ANTES de la imputación con media: 183
2025-05-17 01:51:22,514 - INFO - La media calculada para 'number_of_reviews' es: 27.517948466257668 (se usará como entero: 28)
2025-05-17 01:51:22,514 - INFO - Nulos en 'number_of_reviews' DESPUÉS de la imputación: 0
2025-05-17 01:51:22,527 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 01:51:22,538 - INFO - No se encontraron valores nulos en df_cleaning actualmente.
2025-05-17 01:51:22,587 - INFO - Celda 13: Preparando para subir df_cleaning a la nueva tabla 'cleaned_airbnb_listings' en PostgreSQL.
2025-05-17 01:51:22,598 - INFO - Celda 13.1: Definiendo esquema y creando la tabla vacía 'cleaned_airbnb_listings'.
2025-05-17 01:51:22,609 - INFO - Ejecutando: DROP TABLE IF EXISTS "cleaned_airbnb_listings";
2025-05-17 01:51:22,611 - INFO - Tabla 'cleaned_airbnb_listings' eliminada si existía.
2025-05-17 01:51:22,611 - INFO - Ejecutando: 
    CREATE TABLE IF NOT EXISTS "cleaned_airbnb_listings" (
        "id" BIGINT PRIMARY KEY, "name" TEXT, "host_id" BIGINT, "neighbourhood_group" TEXT, "neighbourhood" TEXT, "lat" DOUBLE PRECISION, "long" DOUBLE PRECISION, "country" TEXT, "cancellation_policy" TEXT, "room_type" TEXT, "construction_year" INTEGER, "price" DOUBLE PRECISION, "service_fee" DOUBLE PRECISION, "minimum_nights" INTEGER, "number_of_reviews" INTEGER, "last_review" TIMESTAMP WITHOUT TIME ZONE, "reviews_per_month" DOUBLE PRECISION, "review_rate_number" INTEGER, "calculated_host_listings_count" INTEGER, "availability_365" INTEGER, "is_host_unconfirmed" BOOLEAN, "is_host_verified" BOOLEAN, "is_instant_bookable_false_policy" BOOLEAN, "is_instant_bookable_true_policy" BOOLEAN
    );
    
2025-05-17 01:51:22,614 - INFO - Tabla vacía 'cleaned_airbnb_listings' creada exitosamente con el esquema definido.
2025-05-17 01:51:22,625 - INFO - Celda 13.2: Preparando df_cleaning para la carga a 'cleaned_airbnb_listings'.
2025-05-17 01:51:22,644 - INFO - df_to_upload creado con 24 columnas en el orden especificado.
2025-05-17 01:51:22,651 - INFO - Columna 'review_rate_number' (category) convertida a Int64 para la carga a SQL.
2025-05-17 01:51:22,675 - INFO - Celda 13.3: Insertando datos de df_to_upload en la tabla 'cleaned_airbnb_listings'.
2025-05-17 01:51:22,676 - INFO - Intentando insertar 102058 filas en 'cleaned_airbnb_listings'.
2025-05-17 01:51:27,966 - INFO - Datos insertados exitosamente en la tabla 'cleaned_airbnb_listings'.
2025-05-17 01:51:27,967 - INFO - Conexión del motor SQLAlchemy (engine_upload) dispuesta después de la carga.
2025-05-17 01:51:27,975 - INFO - Celda 13.4: Verificando las primeras filas de la tabla 'cleaned_airbnb_listings' desde PostgreSQL.
2025-05-17 01:51:27,987 - INFO - Primeras 5 filas obtenidas de 'cleaned_airbnb_listings' en PostgreSQL:
2025-05-17 01:51:27,990 - INFO - Conexión del motor SQLAlchemy (engine_verify) dispuesta.
2025-05-17 01:51:27,995 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 02:01:14,620 - INFO - Inicio del notebook de Limpieza de Datos (003_data_cleaning.ipynb).
2025-05-17 02:01:14,621 - INFO - Configuraciones de Pandas para visualización aplicadas.
2025-05-17 02:01:14,631 - INFO - Ruta del archivo .env: /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 02:01:14,632 - INFO - Nombre de la tabla en PostgreSQL a leer: raw_airbnb
2025-05-17 02:01:14,634 - INFO - Archivo .env encontrado y cargado desde /home/nicolas/Escritorio/proyecto ETL/develop/env/.env
2025-05-17 02:01:14,635 - INFO - Variables de entorno para PostgreSQL cargadas correctamente.
2025-05-17 02:01:14,705 - INFO - Intentando conectar a la base de datos PostgreSQL y extraer datos.
2025-05-17 02:01:14,707 - INFO - Consultando la tabla completa 'raw_airbnb'...
2025-05-17 02:01:15,766 - INFO - Datos extraídos exitosamente de la tabla 'raw_airbnb'.
2025-05-17 02:01:15,766 - INFO - El DataFrame df_raw tiene 102599 filas y 26 columnas.
2025-05-17 02:01:15,767 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
2025-05-17 02:01:15,804 - INFO - Copia de df_raw creada como df_cleaning para el proceso de limpieza.
2025-05-17 02:01:15,812 - INFO - Celda 5: Iniciando eliminación de filas duplicadas.
2025-05-17 02:01:15,813 - INFO - Número de filas antes de eliminar duplicados: 102599
2025-05-17 02:01:16,073 - INFO - Número de filas duplicadas encontradas en df_cleaning: 541
2025-05-17 02:01:16,363 - INFO - Se eliminaron 541 filas duplicadas.
2025-05-17 02:01:16,363 - INFO - Número de filas después de eliminar duplicados: 102058
2025-05-17 02:01:16,364 - INFO - Índice del DataFrame df_cleaning reseteado.
2025-05-17 02:01:16,370 - INFO - Celda 4.1: Iniciando normalización de nombres de columnas en df_cleaning.
2025-05-17 02:01:16,371 - INFO - Nombres de  columnas  originales: ['id', 'NAME', 'host id', 'host_identity_verified', 'host name', 'neighbourhood group', 'neighbourhood', 'lat', 'long', 'country', 'country code', 'instant_bookable', 'cancellation_policy', 'room type', 'Construction year', 'price', 'service fee', 'minimum nights', 'number of reviews', 'last review', 'reviews per month', 'review rate number', 'calculated host listings count', 'availability 365', 'house_rules', 'license']
2025-05-17 02:01:16,372 - INFO - Nombres de columnas normalizados: ['id', 'name', 'host_id', 'host_identity_verified', 'host_name', 'neighbourhood_group', 'neighbourhood', 'lat', 'long', 'country', 'country_code', 'instant_bookable', 'cancellation_policy', 'room_type', 'construction_year', 'price', 'service_fee', 'minimum_nights', 'number_of_reviews', 'last_review', 'reviews_per_month', 'review_rate_number', 'calculated_host_listings_count', 'availability_365', 'house_rules', 'license']
2025-05-17 02:01:16,392 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 02:01:16,455 - INFO - Valores únicos para 'host_identity_verified': ['unconfirmed' 'verified' None] (Total: 3)
2025-05-17 02:01:16,602 - INFO - Valores únicos para 'instant_bookable': ['false' 'true' None] (Total: 3)
2025-05-17 02:01:16,757 - INFO - Celda 7: Iniciando transformación de tipos de datos - Columnas Booleanas.
2025-05-17 02:01:16,759 - INFO - Procesando 'host_identity_verified'.
2025-05-17 02:01:16,797 - INFO - Columna 'is_host_unconfirmed' creada. True si original es 'unconfirmed', False en otros casos.
2025-05-17 02:01:16,836 - INFO - Columna 'is_host_verified' creada. True si original es 'verified', False en otros casos.
2025-05-17 02:01:16,837 - INFO - Procesando 'instant_bookable'.
2025-05-17 02:01:16,878 - INFO - Columna 'is_instant_bookable_false_policy' creada. True si original es 'FALSE', False en otros casos.
2025-05-17 02:01:16,921 - INFO - Columna 'is_instant_bookable_true_policy' creada. True si original es 'TRUE', False en otros casos.
2025-05-17 02:01:16,971 - INFO - Columnas originales ['host_identity_verified', 'instant_bookable'] eliminadas después de crear sus derivados booleanos.
2025-05-17 02:01:16,971 - INFO - Transformaciones de tipo booleano completadas.
2025-05-17 02:01:16,978 - INFO - Analizando valores únicos para columnas con 2 o menos valores únicos en df_cleaning.
2025-05-17 02:01:17,069 - INFO - Valores únicos para 'neighbourhood_group': ['Brooklyn' 'Manhattan' 'brookln' 'manhatan' 'Queens' None 'Staten Island'
 'Bronx'] (Total: 8)
2025-05-17 02:01:17,172 - INFO - Valores únicos para 'cancellation_policy': ['strict' 'moderate' 'flexible' None] (Total: 4)
2025-05-17 02:01:17,225 - INFO - Valores únicos para 'room_type': ['Private room' 'Entire home/apt' 'Shared room' 'Hotel room'] (Total: 4)
2025-05-17 02:01:17,300 - INFO - Valores únicos para 'review_rate_number': [ 4.  5.  3. nan  2.  1.] (Total: 6)
2025-05-17 02:01:17,338 - INFO - Celda 8: Iniciando transformación de tipos de datos - Columnas Categóricas.
2025-05-17 02:01:17,338 - INFO - Columnas a convertir a categórico: ['neighbourhood_group', 'cancellation_policy', 'room_type', 'review_rate_number', 'neighbourhood']
2025-05-17 02:01:17,434 - INFO - Columna 'neighbourhood_group' (tipo original: object) convertida a category.
2025-05-17 02:01:17,523 - INFO - Columna 'cancellation_policy' (tipo original: object) convertida a category.
2025-05-17 02:01:17,615 - INFO - Columna 'room_type' (tipo original: object) convertida a category.
2025-05-17 02:01:17,617 - INFO - Columna 'review_rate_number' (tipo original: float64) convertida a category.
2025-05-17 02:01:17,618 - INFO - La columna 'review_rate_number' contiene valores NaN/pd.NA además de sus categorías.
2025-05-17 02:01:17,710 - INFO - Columna 'neighbourhood' (tipo original: object) convertida a category.
2025-05-17 02:01:17,711 - INFO - Transformaciones de tipo categórico completadas.
2025-05-17 02:01:17,718 - INFO - Celda 8.1: Calculando el conteo de valores únicos para columnas no categóricas y no booleanas.
2025-05-17 02:01:17,897 - INFO - Tabla resumen de conteo de valores únicos generada y mostrada.
2025-05-17 02:01:17,908 - INFO - Celda 9: Iniciando transformación de tipos de datos - Numéricos y Fecha.
2025-05-17 02:01:17,909 - INFO - Convirtiendo 'last_review' a datetime.
2025-05-17 02:01:17,947 - INFO - Limpiando y convirtiendo 'price' a float como 'price'.
2025-05-17 02:01:18,048 - INFO - Limpiando y convirtiendo 'service_fee' a float como 'service_fee'.
2025-05-17 02:01:18,149 - INFO - Convirtiendo 'number_of_reviews' a Int64 (nullable integer).
2025-05-17 02:01:18,155 - INFO - Convirtiendo 'availability_365' a Int64 (nullable integer).
2025-05-17 02:01:18,161 - INFO - Convirtiendo 'minimum_nights' a Int64 (nullable integer).
2025-05-17 02:01:18,166 - INFO - Convirtiendo 'calculated_host_listings_count' a Int64 (nullable integer).
2025-05-17 02:01:18,171 - INFO - Convirtiendo 'construction_year' a Int64 (nullable integer).
2025-05-17 02:01:18,177 - INFO - Transformaciones de tipos numéricos y de fecha completadas.
2025-05-17 02:01:18,184 - INFO - Celda 6: Intentando eliminar la columna 'license' (normalizada).
2025-05-17 02:01:18,217 - INFO - Columna 'license' eliminada exitosamente.
2025-05-17 02:01:18,218 - INFO - Dimensiones de df_cleaning después de eliminar 'license': (102058, 27)
2025-05-17 02:01:18,226 - INFO - Celda 10.1: Identificando valores fuera de rango en 'availability_365'.
2025-05-17 02:01:18,228 - INFO - Analizando columna 'availability_365' (Tipo actual: Int64).
2025-05-17 02:01:18,240 - INFO - Para 'availability_365':
2025-05-17 02:01:18,241 - INFO -   - Número de valores < 0: 431
2025-05-17 02:01:18,242 - INFO -     Valores únicos encontrados < 0: [-9, -10, -2, -1, -6, -4, -8, -5, -3, -7]
2025-05-17 02:01:18,243 - INFO -   - Número de valores > 365: 2754
2025-05-17 02:01:18,244 - INFO -     Valores únicos encontrados > 365 (hasta 20): [374, 375, 372, 383, 411, 416, 405, 393, 400, 417]
2025-05-17 02:01:18,251 - INFO - Celda 10.2: Aplicando corrección (clipping) a 'availability_365'.
2025-05-17 02:01:18,256 - INFO - Valores en 'availability_365' corregidos (clipping entre 1 y 365).
2025-05-17 02:01:18,259 - INFO - Nuevo rango para 'availability_365' después de la corrección: Min=1, Max=365
2025-05-17 02:01:18,269 - INFO - Celda 11.1: Identificando valores fuera de rango en 'minimum_nights'.
2025-05-17 02:01:18,270 - INFO - Analizando columna 'minimum_nights' (Tipo actual: Int64).
2025-05-17 02:01:18,273 - INFO - Para 'minimum_nights':
2025-05-17 02:01:18,274 - INFO -   - Número de valores < 1: 13
2025-05-17 02:01:18,276 - INFO -     Valores únicos encontrados < 1: [-10, -5, -1, -12, -2, -3, -1223, -365, -200, -125]
2025-05-17 02:01:18,277 - INFO -   - Número de valores > 365: 35
2025-05-17 02:01:18,277 - INFO -     Valores únicos encontrados > 365 (hasta 20): [371, 366, 399, 452, 3455, 398, 370, 1000, 1250, 500]
2025-05-17 02:01:18,286 - INFO - Celda 11.2: Aplicando corrección (clipping) a 'minimum_nights'.
2025-05-17 02:01:18,294 - INFO - Valores en 'minimum_nights' corregidos (clipping entre 1 y 365).
2025-05-17 02:01:18,295 - INFO - Nuevo rango para 'minimum_nights' después de la corrección: Min=1, Max=365
2025-05-17 02:01:18,411 - INFO - Celda 12.1: Iniciando imputación de nulos para 'lat' y 'long'.
2025-05-17 02:01:18,413 - INFO - Nulos en 'lat' ANTES de la imputación: 8
2025-05-17 02:01:18,435 - INFO - Nulos en 'lat' DESPUÉS de la imputación: 0
2025-05-17 02:01:18,436 - INFO - Nulos en 'long' ANTES de la imputación: 8
2025-05-17 02:01:18,456 - INFO - Nulos en 'long' DESPUÉS de la imputación: 0
2025-05-17 02:01:18,466 - INFO - Celda 12.4: Iniciando imputación de nulos para 'country' y 'country_code'.
2025-05-17 02:01:18,477 - INFO - Nulos en 'country' ANTES de la imputación: 532
2025-05-17 02:01:18,499 - INFO - La moda para 'country' es: 'United States'
2025-05-17 02:01:18,527 - INFO - Nulos en 'country' DESPUÉS de la imputación: 0
2025-05-17 02:01:18,544 - INFO - Convirtiendo 'country' a tipo 'category' después de la imputación.
2025-05-17 02:01:18,569 - INFO - Nulos en 'country_code' ANTES de la imputación: 131
2025-05-17 02:01:18,595 - INFO - La moda para 'country_code' es: 'US'
2025-05-17 02:01:18,623 - INFO - Nulos en 'country_code' DESPUÉS de la imputación: 0
2025-05-17 02:01:18,637 - INFO - Convirtiendo 'country_code' a tipo 'category' después de la imputación.
2025-05-17 02:01:18,667 - INFO - Celda 12.5: Eliminando la columna 'host_name'.
2025-05-17 02:01:18,679 - INFO - Columna 'host_name' encontrada. Nulos antes de eliminar: 404.
2025-05-17 02:01:18,689 - INFO - Columna 'host_name' eliminada exitosamente.
2025-05-17 02:01:18,690 - INFO - Dimensiones de df_cleaning después de eliminar 'host_name': (102058, 26)
2025-05-17 02:01:18,699 - INFO - Celda 12.7.1: Identificando fechas anómalas (posteriores a 2024) en 'last_review'.
2025-05-17 02:01:18,701 - INFO - Límite superior para fechas válidas en 'last_review': 2024-12-31
2025-05-17 02:01:18,703 - INFO - Número de fechas en 'last_review' posteriores a 2024-12-31: 4
2025-05-17 02:01:18,704 - INFO - Ejemplos de fechas anómalas: [Timestamp('2025-06-26 00:00:00'), Timestamp('2058-06-16 00:00:00'), Timestamp('2026-03-28 00:00:00'), Timestamp('2040-06-16 00:00:00')]
2025-05-17 02:01:18,718 - INFO - Celda 12.7.2: Corrigiendo fechas anómalas en 'last_review' reemplazándolas con NaT.
2025-05-17 02:01:18,723 - INFO - 4 fechas anómalas en 'last_review' han sido reemplazadas con NaT.
2025-05-17 02:01:18,725 - INFO - Verificación: No quedan fechas anómalas (posteriores al límite).
2025-05-17 02:01:18,739 - INFO - Celda 12.7.3: Iniciando imputación de NaT's para 'last_review' con la media (corregida).
2025-05-17 02:01:18,742 - INFO - Total de NaT's en 'last_review' ANTES de la imputación con media: 15836
2025-05-17 02:01:18,744 - INFO - La fecha media (corregida) calculada para 'last_review' es: 2019-06-10 18:47:53.419777024
2025-05-17 02:01:18,745 - INFO - NaT's en 'last_review' DESPUÉS de la imputación con media: 0
2025-05-17 02:01:18,776 - INFO - Celda 12.8: Iniciando imputación de nulos para 'reviews_per_month' con estrategia personalizada.
2025-05-17 02:01:18,778 - INFO - Nulos en 'reviews_per_month' ANTES de la imputación: 15818
2025-05-17 02:01:18,780 - INFO - Estadísticas de 'reviews_per_month' (existentes): Media=1.38, StdDev=1.75, MinObs=0.01, MaxObs=90.00
2025-05-17 02:01:18,781 - INFO - Parámetros de imputación: MediaImp=1.38, StdImp=1.24, LimInf=1.00, LimSup=90.00
2025-05-17 02:01:18,785 - INFO - Nulos en 'reviews_per_month' DESPUÉS de la imputación: 0
2025-05-17 02:01:18,798 - INFO - Celda 12.9: Iniciando imputación de nulos para 'availability_365' con la mediana.
2025-05-17 02:01:18,800 - INFO - Nulos en 'availability_365' ANTES de la imputación con mediana: 448
2025-05-17 02:01:18,802 - INFO - La mediana calculada para 'availability_365' es: 96.0 (se usará como entero: 96)
2025-05-17 02:01:18,804 - INFO - Nulos en 'availability_365' DESPUÉS de la imputación: 0
2025-05-17 02:01:18,818 - INFO - Celda 12.10: Iniciando imputación probabilística de nulos para 'minimum_nights'.
2025-05-17 02:01:18,820 - INFO - Nulos en 'minimum_nights' ANTES de la imputación: 400
2025-05-17 02:01:18,821 - INFO - Valores para imputación en 'minimum_nights': [1, 2, 3, 4, 5, 6, 7, 8]
2025-05-17 02:01:18,822 - INFO - Probabilidades asociadas: [0.2916666666666667, 0.125, 0.125, 0.125, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333, 0.08333333333333333]
2025-05-17 02:01:18,826 - INFO - Nulos en 'minimum_nights' DESPUÉS de la imputación: 0
2025-05-17 02:01:18,841 - INFO - Celda 12.11: Iniciando imputación de nulos para 'calculated_host_listings_count' con la media.
2025-05-17 02:01:18,843 - INFO - Nulos en 'calculated_host_listings_count' ANTES de la imputación con media: 319
2025-05-17 02:01:18,845 - INFO - La media calculada para 'calculated_host_listings_count' es: 7.936936671286331 (se usará como entero: 8)
2025-05-17 02:01:18,846 - INFO - Nulos en 'calculated_host_listings_count' DESPUÉS de la imputación: 0
2025-05-17 02:01:18,862 - INFO - Celda 12.12: Iniciando imputación de nulos para 'review_rate_number' con moda condicionada.
2025-05-17 02:01:18,865 - INFO - Nulos en 'review_rate_number' ANTES de la imputación: 319
2025-05-17 02:01:20,728 - INFO - Nulos en 'review_rate_number' DESPUÉS de la imputación: 0
2025-05-17 02:01:20,738 - INFO - Celda 12.13: Iniciando imputación de nulos para 'service_fee' con la mediana.
2025-05-17 02:01:20,740 - INFO - Nulos en 'service_fee' ANTES de la imputación con mediana: 273
2025-05-17 02:01:20,744 - INFO - La mediana calculada para 'service_fee' es: 125.00
2025-05-17 02:01:20,746 - INFO - Nulos en 'service_fee' DESPUÉS de la imputación: 0
2025-05-17 02:01:20,761 - INFO - Celda 12.14: Iniciando imputación de nulos para 'name' con 'Desconocido'.
2025-05-17 02:01:20,769 - INFO - Nulos en 'name' ANTES de la imputación: 250
2025-05-17 02:01:20,794 - INFO - Nulos en 'name' DESPUÉS de la imputación: 0
2025-05-17 02:01:20,911 - INFO - Celda 12.15: Iniciando imputación de nulos para 'price' con media condicionada por 'neighbourhood'.
2025-05-17 02:01:20,913 - INFO - Nulos en 'price' ANTES de la imputación: 247
2025-05-17 02:01:20,914 - INFO - Media global de 'price' (para fallback): 625.36
2025-05-17 02:01:21,367 - INFO - Nulos en 'price' DESPUÉS de la imputación: 0
2025-05-17 02:01:21,381 - INFO - Celda 12.16: Iniciando imputación de nulos para 'construction_year' con un valor placeholder.
2025-05-17 02:01:21,382 - INFO - Nulos (pd.NA) en 'construction_year' ANTES de la imputación: 214
2025-05-17 02:01:21,384 - INFO - Nulos en 'construction_year' DESPUÉS de la imputación: 0
2025-05-17 02:01:21,400 - INFO - Celda 12.17: Iniciando imputación de nulos para 'number_of_reviews' con la media.
2025-05-17 02:01:21,402 - INFO - Nulos en 'number_of_reviews' ANTES de la imputación con media: 183
2025-05-17 02:01:21,404 - INFO - La media calculada para 'number_of_reviews' es: 27.517948466257668 (se usará como entero: 28)
2025-05-17 02:01:21,405 - INFO - Nulos en 'number_of_reviews' DESPUÉS de la imputación: 0
2025-05-17 02:01:21,423 - INFO - Celda 12.18: Corrigiendo errores tipográficos en 'neighbourhood_group'.
2025-05-17 02:01:21,427 - INFO - Valores únicos en 'neighbourhood_group' ANTES de la corrección: ['Bronx', 'Brooklyn', 'Manhattan', 'None', 'Queens', 'Staten Island', 'brookln', 'manhatan']
2025-05-17 02:01:21,429 - INFO - Reemplazado 'brookln' por 'Brooklyn' en 'neighbourhood_group' (1 ocurrencias).
2025-05-17 02:01:21,432 - INFO - Reemplazado 'manhatan' por 'Manhattan' en 'neighbourhood_group' (1 ocurrencias).
2025-05-17 02:01:21,433 - INFO - Correcciones tipográficas aplicadas.
2025-05-17 02:01:21,435 - INFO - 'neighbourhood_group' re-categorizada para optimizar categorías.
2025-05-17 02:01:21,435 - INFO - Valores únicos en 'neighbourhood_group' DESPUÉS de la corrección: ['Bronx', 'Brooklyn', 'Manhattan', 'None', 'Queens', 'Staten Island']
2025-05-17 02:01:21,446 - INFO - Celda 12.3: Verificando el estado actual de valores nulos por columna en df_cleaning.
2025-05-17 02:01:21,460 - INFO - No se encontraron valores nulos en df_cleaning actualmente.
2025-05-17 02:01:21,524 - INFO - Celda 13: Preparando para subir df_cleaning a la nueva tabla 'cleaned_airbnb_listings' en PostgreSQL.
2025-05-17 02:01:21,554 - INFO - Celda 13.1: Definiendo esquema y creando la tabla vacía 'cleaned_airbnb_listings'.
2025-05-17 02:01:21,575 - INFO - Ejecutando: DROP TABLE IF EXISTS "cleaned_airbnb_listings";
2025-05-17 02:01:21,578 - INFO - Tabla 'cleaned_airbnb_listings' eliminada si existía.
2025-05-17 02:01:21,580 - INFO - Ejecutando: 
    CREATE TABLE IF NOT EXISTS "cleaned_airbnb_listings" (
        "id" BIGINT PRIMARY KEY, "name" TEXT, "host_id" BIGINT, "neighbourhood_group" TEXT, "neighbourhood" TEXT, "lat" DOUBLE PRECISION, "long" DOUBLE PRECISION, "country" TEXT, "cancellation_policy" TEXT, "room_type" TEXT, "construction_year" INTEGER, "price" DOUBLE PRECISION, "service_fee" DOUBLE PRECISION, "minimum_nights" INTEGER, "number_of_reviews" INTEGER, "last_review" TIMESTAMP WITHOUT TIME ZONE, "reviews_per_month" DOUBLE PRECISION, "review_rate_number" INTEGER, "calculated_host_listings_count" INTEGER, "availability_365" INTEGER, "is_host_unconfirmed" BOOLEAN, "is_host_verified" BOOLEAN, "is_instant_bookable_false_policy" BOOLEAN, "is_instant_bookable_true_policy" BOOLEAN
    );
    
2025-05-17 02:01:21,595 - INFO - Tabla vacía 'cleaned_airbnb_listings' creada exitosamente con el esquema definido.
2025-05-17 02:01:21,619 - INFO - Celda 13.2: Preparando df_cleaning para la carga a 'cleaned_airbnb_listings'.
2025-05-17 02:01:21,642 - INFO - df_to_upload creado con 24 columnas en el orden especificado.
2025-05-17 02:01:21,653 - INFO - Columna 'review_rate_number' (category) convertida a Int64 para la carga a SQL.
2025-05-17 02:01:21,694 - INFO - Celda 13.3: Insertando datos de df_to_upload en la tabla 'cleaned_airbnb_listings'.
2025-05-17 02:01:21,697 - INFO - Intentando insertar 102058 filas en 'cleaned_airbnb_listings'.
2025-05-17 02:01:27,016 - INFO - Datos insertados exitosamente en la tabla 'cleaned_airbnb_listings'.
2025-05-17 02:01:27,017 - INFO - Conexión del motor SQLAlchemy (engine_upload) dispuesta después de la carga.
2025-05-17 02:01:27,025 - INFO - Celda 13.4: Verificando las primeras filas de la tabla 'cleaned_airbnb_listings' desde PostgreSQL.
2025-05-17 02:01:27,037 - INFO - Primeras 5 filas obtenidas de 'cleaned_airbnb_listings' en PostgreSQL:
2025-05-17 02:01:27,040 - INFO - Conexión del motor SQLAlchemy (engine_verify) dispuesta.
2025-05-17 02:01:27,046 - INFO - Conexiones del motor de SQLAlchemy dispuestas (cerradas).
